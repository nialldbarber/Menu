200711e0f41bdfa6295f93ca93ba8ee7
'use strict';

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _NativeAnimatedModule = _interopRequireDefault(require("./NativeAnimatedModule"));

var _NativeAnimatedTurboModule = _interopRequireDefault(require("./NativeAnimatedTurboModule"));

var _NativeEventEmitter = _interopRequireDefault(require("../EventEmitter/NativeEventEmitter"));

var _Platform = _interopRequireDefault(require("../Utilities/Platform"));

var _invariant = _interopRequireDefault(require("invariant"));

var NativeAnimatedModule = _Platform.default.OS === 'ios' && global.RN$Bridgeless ? _NativeAnimatedTurboModule.default : _NativeAnimatedModule.default;
var __nativeAnimatedNodeTagCount = 1;
var __nativeAnimationIdCount = 1;
var nativeEventEmitter;
var waitingForQueuedOperations = new Set();
var queueOperations = false;
var queue = [];
var API = {
  getValue: function getValue(tag, saveValueCallback) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');

    if (NativeAnimatedModule.getValue) {
      NativeAnimatedModule.getValue(tag, saveValueCallback);
    }
  },
  setWaitingForIdentifier: function setWaitingForIdentifier(id) {
    waitingForQueuedOperations.add(id);
    queueOperations = true;
  },
  unsetWaitingForIdentifier: function unsetWaitingForIdentifier(id) {
    waitingForQueuedOperations.delete(id);

    if (waitingForQueuedOperations.size === 0) {
      queueOperations = false;
      API.disableQueue();
    }
  },
  disableQueue: function disableQueue() {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');

    if (_Platform.default.OS === 'android') {
      NativeAnimatedModule.startOperationBatch();
    }

    for (var q = 0, l = queue.length; q < l; q++) {
      queue[q]();
    }

    queue.length = 0;

    if (_Platform.default.OS === 'android') {
      NativeAnimatedModule.finishOperationBatch();
    }
  },
  queueOperation: function queueOperation(fn) {
    if (queueOperations) {
      queue.push(fn);
    } else {
      fn();
    }
  },
  createAnimatedNode: function createAnimatedNode(tag, config) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.createAnimatedNode(tag, config);
    });
  },
  startListeningToAnimatedNodeValue: function startListeningToAnimatedNodeValue(tag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.startListeningToAnimatedNodeValue(tag);
    });
  },
  stopListeningToAnimatedNodeValue: function stopListeningToAnimatedNodeValue(tag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.stopListeningToAnimatedNodeValue(tag);
    });
  },
  connectAnimatedNodes: function connectAnimatedNodes(parentTag, childTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.connectAnimatedNodes(parentTag, childTag);
    });
  },
  disconnectAnimatedNodes: function disconnectAnimatedNodes(parentTag, childTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.disconnectAnimatedNodes(parentTag, childTag);
    });
  },
  startAnimatingNode: function startAnimatingNode(animationId, nodeTag, config, endCallback) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.startAnimatingNode(animationId, nodeTag, config, endCallback);
    });
  },
  stopAnimation: function stopAnimation(animationId) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.stopAnimation(animationId);
    });
  },
  setAnimatedNodeValue: function setAnimatedNodeValue(nodeTag, value) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.setAnimatedNodeValue(nodeTag, value);
    });
  },
  setAnimatedNodeOffset: function setAnimatedNodeOffset(nodeTag, offset) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.setAnimatedNodeOffset(nodeTag, offset);
    });
  },
  flattenAnimatedNodeOffset: function flattenAnimatedNodeOffset(nodeTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.flattenAnimatedNodeOffset(nodeTag);
    });
  },
  extractAnimatedNodeOffset: function extractAnimatedNodeOffset(nodeTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.extractAnimatedNodeOffset(nodeTag);
    });
  },
  connectAnimatedNodeToView: function connectAnimatedNodeToView(nodeTag, viewTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.connectAnimatedNodeToView(nodeTag, viewTag);
    });
  },
  disconnectAnimatedNodeFromView: function disconnectAnimatedNodeFromView(nodeTag, viewTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.disconnectAnimatedNodeFromView(nodeTag, viewTag);
    });
  },
  restoreDefaultValues: function restoreDefaultValues(nodeTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');

    if (NativeAnimatedModule.restoreDefaultValues != null) {
      API.queueOperation(function () {
        return NativeAnimatedModule.restoreDefaultValues(nodeTag);
      });
    }
  },
  dropAnimatedNode: function dropAnimatedNode(tag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.dropAnimatedNode(tag);
    });
  },
  addAnimatedEventToView: function addAnimatedEventToView(viewTag, eventName, eventMapping) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.addAnimatedEventToView(viewTag, eventName, eventMapping);
    });
  },
  removeAnimatedEventFromView: function removeAnimatedEventFromView(viewTag, eventName, animatedNodeTag) {
    (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
    API.queueOperation(function () {
      return NativeAnimatedModule.removeAnimatedEventFromView(viewTag, eventName, animatedNodeTag);
    });
  }
};
var SUPPORTED_STYLES = {
  opacity: true,
  transform: true,
  borderRadius: true,
  borderBottomEndRadius: true,
  borderBottomLeftRadius: true,
  borderBottomRightRadius: true,
  borderBottomStartRadius: true,
  borderTopEndRadius: true,
  borderTopLeftRadius: true,
  borderTopRightRadius: true,
  borderTopStartRadius: true,
  elevation: true,
  zIndex: true,
  shadowOpacity: true,
  shadowRadius: true,
  scaleX: true,
  scaleY: true,
  translateX: true,
  translateY: true
};
var SUPPORTED_TRANSFORMS = {
  translateX: true,
  translateY: true,
  scale: true,
  scaleX: true,
  scaleY: true,
  rotate: true,
  rotateX: true,
  rotateY: true,
  rotateZ: true,
  perspective: true
};
var SUPPORTED_INTERPOLATION_PARAMS = {
  inputRange: true,
  outputRange: true,
  extrapolate: true,
  extrapolateRight: true,
  extrapolateLeft: true
};

function addWhitelistedStyleProp(prop) {
  SUPPORTED_STYLES[prop] = true;
}

function addWhitelistedTransformProp(prop) {
  SUPPORTED_TRANSFORMS[prop] = true;
}

function addWhitelistedInterpolationParam(param) {
  SUPPORTED_INTERPOLATION_PARAMS[param] = true;
}

function validateTransform(configs) {
  configs.forEach(function (config) {
    if (!SUPPORTED_TRANSFORMS.hasOwnProperty(config.property)) {
      throw new Error("Property '" + config.property + "' is not supported by native animated module");
    }
  });
}

function validateStyles(styles) {
  for (var _key in styles) {
    if (!SUPPORTED_STYLES.hasOwnProperty(_key)) {
      throw new Error("Style property '" + _key + "' is not supported by native animated module");
    }
  }
}

function validateInterpolation(config) {
  for (var _key2 in config) {
    if (!SUPPORTED_INTERPOLATION_PARAMS.hasOwnProperty(_key2)) {
      throw new Error("Interpolation property '" + _key2 + "' is not supported by native animated module");
    }
  }
}

function generateNewNodeTag() {
  return __nativeAnimatedNodeTagCount++;
}

function generateNewAnimationId() {
  return __nativeAnimationIdCount++;
}

function assertNativeAnimatedModule() {
  (0, _invariant.default)(NativeAnimatedModule, 'Native animated module is not available');
}

var _warnedMissingNativeAnimated = false;

function shouldUseNativeDriver(config) {
  if (config.useNativeDriver == null) {
    console.warn('Animated: `useNativeDriver` was not specified. This is a required ' + 'option and must be explicitly set to `true` or `false`');
  }

  if (config.useNativeDriver === true && !NativeAnimatedModule) {
    if (!_warnedMissingNativeAnimated) {
      console.warn('Animated: `useNativeDriver` is not supported because the native ' + 'animated module is missing. Falling back to JS-based animation. To ' + 'resolve this, add `RCTAnimation` module to this app, or remove ' + '`useNativeDriver`. ' + 'Make sure to run `pod install` first. Read more about autolinking: https://github.com/react-native-community/cli/blob/master/docs/autolinking.md');
      _warnedMissingNativeAnimated = true;
    }

    return false;
  }

  return config.useNativeDriver || false;
}

function transformDataType(value) {
  if (typeof value !== 'string') {
    return value;
  }

  if (/deg$/.test(value)) {
    var degrees = parseFloat(value) || 0;
    var radians = degrees * Math.PI / 180.0;
    return radians;
  } else {
    return value;
  }
}

module.exports = {
  API: API,
  addWhitelistedStyleProp: addWhitelistedStyleProp,
  addWhitelistedTransformProp: addWhitelistedTransformProp,
  addWhitelistedInterpolationParam: addWhitelistedInterpolationParam,
  validateStyles: validateStyles,
  validateTransform: validateTransform,
  validateInterpolation: validateInterpolation,
  generateNewNodeTag: generateNewNodeTag,
  generateNewAnimationId: generateNewAnimationId,
  assertNativeAnimatedModule: assertNativeAnimatedModule,
  shouldUseNativeDriver: shouldUseNativeDriver,
  transformDataType: transformDataType,

  get nativeEventEmitter() {
    if (!nativeEventEmitter) {
      nativeEventEmitter = new _NativeEventEmitter.default(NativeAnimatedModule);
    }

    return nativeEventEmitter;
  }

};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk5hdGl2ZUFuaW1hdGVkSGVscGVyLmpzIl0sIm5hbWVzIjpbIk5hdGl2ZUFuaW1hdGVkTW9kdWxlIiwiUGxhdGZvcm0iLCJPUyIsImdsb2JhbCIsIlJOJEJyaWRnZWxlc3MiLCJOYXRpdmVBbmltYXRlZFR1cmJvTW9kdWxlIiwiTmF0aXZlQW5pbWF0ZWROb25UdXJib01vZHVsZSIsIl9fbmF0aXZlQW5pbWF0ZWROb2RlVGFnQ291bnQiLCJfX25hdGl2ZUFuaW1hdGlvbklkQ291bnQiLCJuYXRpdmVFdmVudEVtaXR0ZXIiLCJ3YWl0aW5nRm9yUXVldWVkT3BlcmF0aW9ucyIsIlNldCIsInF1ZXVlT3BlcmF0aW9ucyIsInF1ZXVlIiwiQVBJIiwiZ2V0VmFsdWUiLCJ0YWciLCJzYXZlVmFsdWVDYWxsYmFjayIsInNldFdhaXRpbmdGb3JJZGVudGlmaWVyIiwiaWQiLCJhZGQiLCJ1bnNldFdhaXRpbmdGb3JJZGVudGlmaWVyIiwiZGVsZXRlIiwic2l6ZSIsImRpc2FibGVRdWV1ZSIsInN0YXJ0T3BlcmF0aW9uQmF0Y2giLCJxIiwibCIsImxlbmd0aCIsImZpbmlzaE9wZXJhdGlvbkJhdGNoIiwicXVldWVPcGVyYXRpb24iLCJmbiIsInB1c2giLCJjcmVhdGVBbmltYXRlZE5vZGUiLCJjb25maWciLCJzdGFydExpc3RlbmluZ1RvQW5pbWF0ZWROb2RlVmFsdWUiLCJzdG9wTGlzdGVuaW5nVG9BbmltYXRlZE5vZGVWYWx1ZSIsImNvbm5lY3RBbmltYXRlZE5vZGVzIiwicGFyZW50VGFnIiwiY2hpbGRUYWciLCJkaXNjb25uZWN0QW5pbWF0ZWROb2RlcyIsInN0YXJ0QW5pbWF0aW5nTm9kZSIsImFuaW1hdGlvbklkIiwibm9kZVRhZyIsImVuZENhbGxiYWNrIiwic3RvcEFuaW1hdGlvbiIsInNldEFuaW1hdGVkTm9kZVZhbHVlIiwidmFsdWUiLCJzZXRBbmltYXRlZE5vZGVPZmZzZXQiLCJvZmZzZXQiLCJmbGF0dGVuQW5pbWF0ZWROb2RlT2Zmc2V0IiwiZXh0cmFjdEFuaW1hdGVkTm9kZU9mZnNldCIsImNvbm5lY3RBbmltYXRlZE5vZGVUb1ZpZXciLCJ2aWV3VGFnIiwiZGlzY29ubmVjdEFuaW1hdGVkTm9kZUZyb21WaWV3IiwicmVzdG9yZURlZmF1bHRWYWx1ZXMiLCJkcm9wQW5pbWF0ZWROb2RlIiwiYWRkQW5pbWF0ZWRFdmVudFRvVmlldyIsImV2ZW50TmFtZSIsImV2ZW50TWFwcGluZyIsInJlbW92ZUFuaW1hdGVkRXZlbnRGcm9tVmlldyIsImFuaW1hdGVkTm9kZVRhZyIsIlNVUFBPUlRFRF9TVFlMRVMiLCJvcGFjaXR5IiwidHJhbnNmb3JtIiwiYm9yZGVyUmFkaXVzIiwiYm9yZGVyQm90dG9tRW5kUmFkaXVzIiwiYm9yZGVyQm90dG9tTGVmdFJhZGl1cyIsImJvcmRlckJvdHRvbVJpZ2h0UmFkaXVzIiwiYm9yZGVyQm90dG9tU3RhcnRSYWRpdXMiLCJib3JkZXJUb3BFbmRSYWRpdXMiLCJib3JkZXJUb3BMZWZ0UmFkaXVzIiwiYm9yZGVyVG9wUmlnaHRSYWRpdXMiLCJib3JkZXJUb3BTdGFydFJhZGl1cyIsImVsZXZhdGlvbiIsInpJbmRleCIsInNoYWRvd09wYWNpdHkiLCJzaGFkb3dSYWRpdXMiLCJzY2FsZVgiLCJzY2FsZVkiLCJ0cmFuc2xhdGVYIiwidHJhbnNsYXRlWSIsIlNVUFBPUlRFRF9UUkFOU0ZPUk1TIiwic2NhbGUiLCJyb3RhdGUiLCJyb3RhdGVYIiwicm90YXRlWSIsInJvdGF0ZVoiLCJwZXJzcGVjdGl2ZSIsIlNVUFBPUlRFRF9JTlRFUlBPTEFUSU9OX1BBUkFNUyIsImlucHV0UmFuZ2UiLCJvdXRwdXRSYW5nZSIsImV4dHJhcG9sYXRlIiwiZXh0cmFwb2xhdGVSaWdodCIsImV4dHJhcG9sYXRlTGVmdCIsImFkZFdoaXRlbGlzdGVkU3R5bGVQcm9wIiwicHJvcCIsImFkZFdoaXRlbGlzdGVkVHJhbnNmb3JtUHJvcCIsImFkZFdoaXRlbGlzdGVkSW50ZXJwb2xhdGlvblBhcmFtIiwicGFyYW0iLCJ2YWxpZGF0ZVRyYW5zZm9ybSIsImNvbmZpZ3MiLCJmb3JFYWNoIiwiaGFzT3duUHJvcGVydHkiLCJwcm9wZXJ0eSIsIkVycm9yIiwidmFsaWRhdGVTdHlsZXMiLCJzdHlsZXMiLCJrZXkiLCJ2YWxpZGF0ZUludGVycG9sYXRpb24iLCJnZW5lcmF0ZU5ld05vZGVUYWciLCJnZW5lcmF0ZU5ld0FuaW1hdGlvbklkIiwiYXNzZXJ0TmF0aXZlQW5pbWF0ZWRNb2R1bGUiLCJfd2FybmVkTWlzc2luZ05hdGl2ZUFuaW1hdGVkIiwic2hvdWxkVXNlTmF0aXZlRHJpdmVyIiwidXNlTmF0aXZlRHJpdmVyIiwiY29uc29sZSIsIndhcm4iLCJ0cmFuc2Zvcm1EYXRhVHlwZSIsInRlc3QiLCJkZWdyZWVzIiwicGFyc2VGbG9hdCIsInJhZGlhbnMiLCJNYXRoIiwiUEkiLCJtb2R1bGUiLCJleHBvcnRzIiwiTmF0aXZlRXZlbnRFbWl0dGVyIl0sIm1hcHBpbmdzIjoiQUFVQTs7OztBQUVBOztBQUNBOztBQUNBOztBQUNBOztBQVNBOztBQUdBLElBQU1BLG9CQUFvQixHQUN4QkMsa0JBQVNDLEVBQVQsS0FBZ0IsS0FBaEIsSUFBeUJDLE1BQU0sQ0FBQ0MsYUFBaEMsR0FDSUMsa0NBREosR0FFSUMsNkJBSE47QUFLQSxJQUFJQyw0QkFBNEIsR0FBRyxDQUFuQztBQUNBLElBQUlDLHdCQUF3QixHQUFHLENBQS9CO0FBRUEsSUFBSUMsa0JBQUo7QUFFQSxJQUFJQywwQkFBMEIsR0FBRyxJQUFJQyxHQUFKLEVBQWpDO0FBQ0EsSUFBSUMsZUFBZSxHQUFHLEtBQXRCO0FBQ0EsSUFBSUMsS0FBd0IsR0FBRyxFQUEvQjtBQU1BLElBQU1DLEdBQUcsR0FBRztBQUNWQyxFQUFBQSxRQUFRLEVBQUUsa0JBQ1JDLEdBRFEsRUFFUkMsaUJBRlEsRUFHRjtBQUNOLDRCQUFVakIsb0JBQVYsRUFBZ0MseUNBQWhDOztBQUNBLFFBQUlBLG9CQUFvQixDQUFDZSxRQUF6QixFQUFtQztBQUNqQ2YsTUFBQUEsb0JBQW9CLENBQUNlLFFBQXJCLENBQThCQyxHQUE5QixFQUFtQ0MsaUJB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QUFQO0FBQ0Q7O0FBQ0QsTUFBSSxPQUFPd0UsSUFBUCxDQUFZeEUsS0FBWixDQUFKLEVBQXdCO0FBQ3RCLFFBQU15RSxPQUFPLEdBQUdDLFVBQVUsQ0FBQzFFLEtBQUQsQ0FBVixJQUFxQixDQUFyQztBQUNBLFFBQU0yRSxPQUFPLEdBQUlGLE9BQU8sR0FBR0csSUFBSSxDQUFDQyxFQUFoQixHQUFzQixLQUF0QztBQUNBLFdBQU9GLE9BQVA7QUFDRCxHQUpELE1BSU87QUFDTCxXQUFPM0UsS0FBUDtBQUNEO0FBQ0Y7O0FBRUQ4RSxNQUFNLENBQUNDLE9BQVAsR0FBaUI7QUFDZmhILEVBQUFBLEdBQUcsRUFBSEEsR0FEZTtBQUVmaUYsRUFBQUEsdUJBQXVCLEVBQXZCQSx1QkFGZTtBQUdmRSxFQUFBQSwyQkFBMkIsRUFBM0JBLDJCQUhlO0FBSWZDLEVBQUFBLGdDQUFnQyxFQUFoQ0EsZ0NBSmU7QUFLZlEsRUFBQUEsY0FBYyxFQUFkQSxjQUxlO0FBTWZOLEVBQUFBLGlCQUFpQixFQUFqQkEsaUJBTmU7QUFPZlMsRUFBQUEscUJBQXFCLEVBQXJCQSxxQkFQZTtBQVFmQyxFQUFBQSxrQkFBa0IsRUFBbEJBLGtCQVJlO0FBU2ZDLEVBQUFBLHNCQUFzQixFQUF0QkEsc0JBVGU7QUFVZkMsRUFBQUEsMEJBQTBCLEVBQTFCQSwwQkFWZTtBQVdmRSxFQUFBQSxxQkFBcUIsRUFBckJBLHFCQVhlO0FBWWZJLEVBQUFBLGlCQUFpQixFQUFqQkEsaUJBWmU7O0FBY2YsTUFBSTdHLGtCQUFKLEdBQTZDO0FBQzNDLFFBQUksQ0FBQ0Esa0JBQUwsRUFBeUI7QUFDdkJBLE1BQUFBLGtCQUFrQixHQUFHLElBQUlzSCwyQkFBSixDQUF1Qi9ILG9CQUF2QixDQUFyQjtBQUNEOztBQUNELFdBQU9TLGtCQUFQO0FBQ0Q7O0FBbkJjLENBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCBOYXRpdmVBbmltYXRlZE5vblR1cmJvTW9kdWxlIGZyb20gJy4vTmF0aXZlQW5pbWF0ZWRNb2R1bGUnO1xuaW1wb3J0IE5hdGl2ZUFuaW1hdGVkVHVyYm9Nb2R1bGUgZnJvbSAnLi9OYXRpdmVBbmltYXRlZFR1cmJvTW9kdWxlJztcbmltcG9ydCBOYXRpdmVFdmVudEVtaXR0ZXIgZnJvbSAnLi4vRXZlbnRFbWl0dGVyL05hdGl2ZUV2ZW50RW1pdHRlcic7XG5pbXBvcnQgUGxhdGZvcm0gZnJvbSAnLi4vVXRpbGl0aWVzL1BsYXRmb3JtJztcbmltcG9ydCB0eXBlIHtFdmVudENvbmZpZ30gZnJvbSAnLi9BbmltYXRlZEV2ZW50JztcbmltcG9ydCB0eXBlIHtcbiAgRXZlbnRNYXBwaW5nLFxuICBBbmltYXRlZE5vZGVDb25maWcsXG4gIEFuaW1hdGluZ05vZGVDb25maWcsXG59IGZyb20gJy4vTmF0aXZlQW5pbWF0ZWRNb2R1bGUnO1xuaW1wb3J0IHR5cGUge0FuaW1hdGlvbkNvbmZpZywgRW5kQ2FsbGJhY2t9IGZyb20gJy4vYW5pbWF0aW9ucy9BbmltYXRpb24nO1xuaW1wb3J0IHR5cGUge0ludGVycG9sYXRpb25Db25maWdUeXBlfSBmcm9tICcuL25vZGVzL0FuaW1hdGVkSW50ZXJwb2xhdGlvbic7XG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2ludmFyaWFudCc7XG5cbi8vIFRPRE8gVDY5NDM3MTUyIEBwZXRldGhlaGVhdCAtIERlbGV0ZSB0aGlzIGZvcmsgd2hlbiBGYWJyaWMgc2hpcHMgdG8gMTAwJS5cbmNvbnN0IE5hdGl2ZUFuaW1hdGVkTW9kdWxlID1cbiAgUGxhdGZvcm0uT1MgPT09ICdpb3MnICYmIGdsb2JhbC5STiRCcmlkZ2VsZXNzXG4gICAgPyBOYXRpdmVBbmltYXRlZFR1cmJvTW9kdWxlXG4gICAgOiBOYXRpdmVBbmltYXRlZE5vblR1cmJvTW9kdWxlO1xuXG5sZXQgX19uYXRpdmVBbmltYXRlZE5vZGVUYWdDb3VudCA9IDE7IC8qIHVzZWQgZm9yIGFuaW1hdGVkIG5vZGVzICovXG5sZXQgX19uYXRpdmVBbmltYXRpb25JZENvdW50ID0gMTsgLyogdXNlZCBmb3Igc3RhcnRlZCBhbmltYXRpb25zICovXG5cbmxldCBuYXRpdmVFdmVudEVtaXR0ZXI7XG5cbmxldCB3YWl0aW5nRm9yUXVldWVkT3BlcmF0aW9ucyA9IG5ldyBTZXQoKTtcbmxldCBxdWV1ZU9wZXJhdGlvbnMgPSBmYWxzZTtcbmxldCBxdWV1ZTogQXJyYXk8KCkgPT4gdm9pZD4gPSBbXTtcblxuLyoqXG4gKiBTaW1wbGUgd3JhcHBlcnMgYXJvdW5kIE5hdGl2ZUFuaW1hdGVkTW9kdWxlIHRvIHByb3ZpZGUgZmxvdyBhbmQgYXV0b2NvbXBsZXRlIHN1cHBvcnQgZm9yXG4gKiB0aGUgbmF0aXZlIG1vZHVsZSBtZXRob2RzXG4gKi9cbmNvbnN0IEFQSSA9IHtcbiAgZ2V0VmFsdWU6IGZ1bmN0aW9uKFxuICAgIHRhZzogbnVtYmVyLFxuICAgIHNhdmVWYWx1ZUNhbGxiYWNrOiAodmFsdWU6IG51bWJlcikgPT4gdm9pZCxcbiAgKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgaWYgKE5hdGl2ZUFuaW1hdGVkTW9kdWxlLmdldFZhbHVlKSB7XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5nZXRWYWx1ZSh0YWcsIHNhdmVWYWx1ZUNhbGxiYWNrKTtcbiAgICB9XG4gIH0sXG4gIHNldFdhaXRpbmdGb3JJZGVudGlmaWVyOiBmdW5jdGlvbihpZDogc3RyaW5nKTogdm9pZCB7XG4gICAgd2FpdGluZ0ZvclF1ZXVlZE9wZXJhdGlvbnMuYWRkKGlkKTtcbiAgICBxdWV1ZU9wZXJhdGlvbnMgPSB0cnVlO1xuICB9LFxuICB1bnNldFdhaXRpbmdGb3JJZGVudGlmaWVyOiBmdW5jdGlvbihpZDogc3RyaW5nKTogdm9pZCB7XG4gICAgd2FpdGluZ0ZvclF1ZXVlZE9wZXJhdGlvbnMuZGVsZXRlKGlkKTtcblxuICAgIGlmICh3YWl0aW5nRm9yUXVldWVkT3BlcmF0aW9ucy5zaXplID09PSAwKSB7XG4gICAgICBxdWV1ZU9wZXJhdGlvbnMgPSBmYWxzZTtcbiAgICAgIEFQSS5kaXNhYmxlUXVldWUoKTtcbiAgICB9XG4gIH0sXG4gIGRpc2FibGVRdWV1ZTogZnVuY3Rpb24oKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG5cbiAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICAgICAgTmF0aXZlQW5pbWF0ZWRNb2R1bGUuc3RhcnRPcGVyYXRpb25CYXRjaCgpO1xuICAgIH1cbiAgICBmb3IgKGxldCBxID0gMCwgbCA9IHF1ZXVlLmxlbmd0aDsgcSA8IGw7IHErKykge1xuICAgICAgcXVldWVbcV0oKTtcbiAgICB9XG4gICAgcXVldWUubGVuZ3RoID0gMDtcbiAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICdhbmRyb2lkJykge1xuICAgICAgTmF0aXZlQW5pbWF0ZWRNb2R1bGUuZmluaXNoT3BlcmF0aW9uQmF0Y2goKTtcbiAgICB9XG4gIH0sXG4gIHF1ZXVlT3BlcmF0aW9uOiAoZm46ICgpID0+IHZvaWQpOiB2b2lkID0+IHtcbiAgICBpZiAocXVldWVPcGVyYXRpb25zKSB7XG4gICAgICBxdWV1ZS5wdXNoKGZuKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm4oKTtcbiAgICB9XG4gIH0sXG4gIGNyZWF0ZUFuaW1hdGVkTm9kZTogZnVuY3Rpb24odGFnOiBudW1iZXIsIGNvbmZpZzogQW5pbWF0ZWROb2RlQ29uZmlnKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgQVBJLnF1ZXVlT3BlcmF0aW9uKCgpID0+XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5jcmVhdGVBbmltYXRlZE5vZGUodGFnLCBjb25maWcpLFxuICAgICk7XG4gIH0sXG4gIHN0YXJ0TGlzdGVuaW5nVG9BbmltYXRlZE5vZGVWYWx1ZTogZnVuY3Rpb24odGFnOiBudW1iZXIpIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgIE5hdGl2ZUFuaW1hdGVkTW9kdWxlLnN0YXJ0TGlzdGVuaW5nVG9BbmltYXRlZE5vZGVWYWx1ZSh0YWcpLFxuICAgICk7XG4gIH0sXG4gIHN0b3BMaXN0ZW5pbmdUb0FuaW1hdGVkTm9kZVZhbHVlOiBmdW5jdGlvbih0YWc6IG51bWJlcikge1xuICAgIGludmFyaWFudChOYXRpdmVBbmltYXRlZE1vZHVsZSwgJ05hdGl2ZSBhbmltYXRlZCBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZScpO1xuICAgIEFQSS5xdWV1ZU9wZXJhdGlvbigoKSA9PlxuICAgICAgTmF0aXZlQW5pbWF0ZWRNb2R1bGUuc3RvcExpc3RlbmluZ1RvQW5pbWF0ZWROb2RlVmFsdWUodGFnKSxcbiAgICApO1xuICB9LFxuICBjb25uZWN0QW5pbWF0ZWROb2RlczogZnVuY3Rpb24ocGFyZW50VGFnOiBudW1iZXIsIGNoaWxkVGFnOiBudW1iZXIpOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgIE5hdGl2ZUFuaW1hdGVkTW9kdWxlLmNvbm5lY3RBbmltYXRlZE5vZGVzKHBhcmVudFRhZywgY2hpbGRUYWcpLFxuICAgICk7XG4gIH0sXG4gIGRpc2Nvbm5lY3RBbmltYXRlZE5vZGVzOiBmdW5jdGlvbihwYXJlbnRUYWc6IG51bWJlciwgY2hpbGRUYWc6IG51bWJlcik6IHZvaWQge1xuICAgIGludmFyaWFudChOYXRpdmVBbmltYXRlZE1vZHVsZSwgJ05hdGl2ZSBhbmltYXRlZCBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZScpO1xuICAgIEFQSS5xdWV1ZU9wZXJhdGlvbigoKSA9PlxuICAgICAgTmF0aXZlQW5pbWF0ZWRNb2R1bGUuZGlzY29ubmVjdEFuaW1hdGVkTm9kZXMocGFyZW50VGFnLCBjaGlsZFRhZyksXG4gICAgKTtcbiAgfSxcbiAgc3RhcnRBbmltYXRpbmdOb2RlOiBmdW5jdGlvbihcbiAgICBhbmltYXRpb25JZDogbnVtYmVyLFxuICAgIG5vZGVUYWc6IG51bWJlcixcbiAgICBjb25maWc6IEFuaW1hdGluZ05vZGVDb25maWcsXG4gICAgZW5kQ2FsbGJhY2s6IEVuZENhbGxiYWNrLFxuICApOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgIE5hdGl2ZUFuaW1hdGVkTW9kdWxlLnN0YXJ0QW5pbWF0aW5nTm9kZShcbiAgICAgICAgYW5pbWF0aW9uSWQsXG4gICAgICAgIG5vZGVUYWcsXG4gICAgICAgIGNvbmZpZyxcbiAgICAgICAgZW5kQ2FsbGJhY2ssXG4gICAgICApLFxuICAgICk7XG4gIH0sXG4gIHN0b3BBbmltYXRpb246IGZ1bmN0aW9uKGFuaW1hdGlvbklkOiBudW1iZXIpIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT4gTmF0aXZlQW5pbWF0ZWRNb2R1bGUuc3RvcEFuaW1hdGlvbihhbmltYXRpb25JZCkpO1xuICB9LFxuICBzZXRBbmltYXRlZE5vZGVWYWx1ZTogZnVuY3Rpb24obm9kZVRhZzogbnVtYmVyLCB2YWx1ZTogbnVtYmVyKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgQVBJLnF1ZXVlT3BlcmF0aW9uKCgpID0+XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5zZXRBbmltYXRlZE5vZGVWYWx1ZShub2RlVGFnLCB2YWx1ZSksXG4gICAgKTtcbiAgfSxcbiAgc2V0QW5pbWF0ZWROb2RlT2Zmc2V0OiBmdW5jdGlvbihub2RlVGFnOiBudW1iZXIsIG9mZnNldDogbnVtYmVyKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgQVBJLnF1ZXVlT3BlcmF0aW9uKCgpID0+XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5zZXRBbmltYXRlZE5vZGVPZmZzZXQobm9kZVRhZywgb2Zmc2V0KSxcbiAgICApO1xuICB9LFxuICBmbGF0dGVuQW5pbWF0ZWROb2RlT2Zmc2V0OiBmdW5jdGlvbihub2RlVGFnOiBudW1iZXIpOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgIE5hdGl2ZUFuaW1hdGVkTW9kdWxlLmZsYXR0ZW5BbmltYXRlZE5vZGVPZmZzZXQobm9kZVRhZyksXG4gICAgKTtcbiAgfSxcbiAgZXh0cmFjdEFuaW1hdGVkTm9kZU9mZnNldDogZnVuY3Rpb24obm9kZVRhZzogbnVtYmVyKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgQVBJLnF1ZXVlT3BlcmF0aW9uKCgpID0+XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5leHRyYWN0QW5pbWF0ZWROb2RlT2Zmc2V0KG5vZGVUYWcpLFxuICAgICk7XG4gIH0sXG4gIGNvbm5lY3RBbmltYXRlZE5vZGVUb1ZpZXc6IGZ1bmN0aW9uKG5vZGVUYWc6IG51bWJlciwgdmlld1RhZzogbnVtYmVyKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgQVBJLnF1ZXVlT3BlcmF0aW9uKCgpID0+XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5jb25uZWN0QW5pbWF0ZWROb2RlVG9WaWV3KG5vZGVUYWcsIHZpZXdUYWcpLFxuICAgICk7XG4gIH0sXG4gIGRpc2Nvbm5lY3RBbmltYXRlZE5vZGVGcm9tVmlldzogZnVuY3Rpb24oXG4gICAgbm9kZVRhZzogbnVtYmVyLFxuICAgIHZpZXdUYWc6IG51bWJlcixcbiAgKTogdm9pZCB7XG4gICAgaW52YXJpYW50KE5hdGl2ZUFuaW1hdGVkTW9kdWxlLCAnTmF0aXZlIGFuaW1hdGVkIG1vZHVsZSBpcyBub3QgYXZhaWxhYmxlJyk7XG4gICAgQVBJLnF1ZXVlT3BlcmF0aW9uKCgpID0+XG4gICAgICBOYXRpdmVBbmltYXRlZE1vZHVsZS5kaXNjb25uZWN0QW5pbWF0ZWROb2RlRnJvbVZpZXcobm9kZVRhZywgdmlld1RhZyksXG4gICAgKTtcbiAgfSxcbiAgcmVzdG9yZURlZmF1bHRWYWx1ZXM6IGZ1bmN0aW9uKG5vZGVUYWc6IG51bWJlcik6IHZvaWQge1xuICAgIGludmFyaWFudChOYXRpdmVBbmltYXRlZE1vZHVsZSwgJ05hdGl2ZSBhbmltYXRlZCBtb2R1bGUgaXMgbm90IGF2YWlsYWJsZScpO1xuICAgIC8vIEJhY2t3YXJkcyBjb21wYXQgd2l0aCBvbGRlciBuYXRpdmUgcnVudGltZXMsIGNhbiBiZSByZW1vdmVkIGxhdGVyLlxuICAgIGlmIChOYXRpdmVBbmltYXRlZE1vZHVsZS5yZXN0b3JlRGVmYXVsdFZhbHVlcyAhPSBudWxsKSB7XG4gICAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgICAgTmF0aXZlQW5pbWF0ZWRNb2R1bGUucmVzdG9yZURlZmF1bHRWYWx1ZXMobm9kZVRhZyksXG4gICAgICApO1xuICAgIH1cbiAgfSxcbiAgZHJvcEFuaW1hdGVkTm9kZTogZnVuY3Rpb24odGFnOiBudW1iZXIpOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT4gTmF0aXZlQW5pbWF0ZWRNb2R1bGUuZHJvcEFuaW1hdGVkTm9kZSh0YWcpKTtcbiAgfSxcbiAgYWRkQW5pbWF0ZWRFdmVudFRvVmlldzogZnVuY3Rpb24oXG4gICAgdmlld1RhZzogbnVtYmVyLFxuICAgIGV2ZW50TmFtZTogc3RyaW5nLFxuICAgIGV2ZW50TWFwcGluZzogRXZlbnRNYXBwaW5nLFxuICApIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgIE5hdGl2ZUFuaW1hdGVkTW9kdWxlLmFkZEFuaW1hdGVkRXZlbnRUb1ZpZXcoXG4gICAgICAgIHZpZXdUYWcsXG4gICAgICAgIGV2ZW50TmFtZSxcbiAgICAgICAgZXZlbnRNYXBwaW5nLFxuICAgICAgKSxcbiAgICApO1xuICB9LFxuICByZW1vdmVBbmltYXRlZEV2ZW50RnJvbVZpZXcoXG4gICAgdmlld1RhZzogbnVtYmVyLFxuICAgIGV2ZW50TmFtZTogc3RyaW5nLFxuICAgIGFuaW1hdGVkTm9kZVRhZzogbnVtYmVyLFxuICApIHtcbiAgICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbiAgICBBUEkucXVldWVPcGVyYXRpb24oKCkgPT5cbiAgICAgIE5hdGl2ZUFuaW1hdGVkTW9kdWxlLnJlbW92ZUFuaW1hdGVkRXZlbnRGcm9tVmlldyhcbiAgICAgICAgdmlld1RhZyxcbiAgICAgICAgZXZlbnROYW1lLFxuICAgICAgICBhbmltYXRlZE5vZGVUYWcsXG4gICAgICApLFxuICAgICk7XG4gIH0sXG59O1xuXG4vKipcbiAqIFN0eWxlcyBhbGxvd2VkIGJ5IHRoZSBuYXRpdmUgYW5pbWF0ZWQgaW1wbGVtZW50YXRpb24uXG4gKlxuICogSW4gZ2VuZXJhbCBuYXRpdmUgYW5pbWF0ZWQgaW1wbGVtZW50YXRpb24gc2hvdWxkIHN1cHBvcnQgYW55IG51bWVyaWMgcHJvcGVydHkgdGhhdCBkb2Vzbid0IG5lZWRcbiAqIHRvIGJlIHVwZGF0ZWQgdGhyb3VnaCB0aGUgc2hhZG93IHZpZXcgaGllcmFyY2h5IChhbGwgbm9uLWxheW91dCBwcm9wZXJ0aWVzKS5cbiAqL1xuY29uc3QgU1VQUE9SVEVEX1NUWUxFUyA9IHtcbiAgb3BhY2l0eTogdHJ1ZSxcbiAgdHJhbnNmb3JtOiB0cnVlLFxuICBib3JkZXJSYWRpdXM6IHRydWUsXG4gIGJvcmRlckJvdHRvbUVuZFJhZGl1czogdHJ1ZSxcbiAgYm9yZGVyQm90dG9tTGVmdFJhZGl1czogdHJ1ZSxcbiAgYm9yZGVyQm90dG9tUmlnaHRSYWRpdXM6IHRydWUsXG4gIGJvcmRlckJvdHRvbVN0YXJ0UmFkaXVzOiB0cnVlLFxuICBib3JkZXJUb3BFbmRSYWRpdXM6IHRydWUsXG4gIGJvcmRlclRvcExlZnRSYWRpdXM6IHRydWUsXG4gIGJvcmRlclRvcFJpZ2h0UmFkaXVzOiB0cnVlLFxuICBib3JkZXJUb3BTdGFydFJhZGl1czogdHJ1ZSxcbiAgZWxldmF0aW9uOiB0cnVlLFxuICB6SW5kZXg6IHRydWUsXG4gIC8qIGlvcyBzdHlsZXMgKi9cbiAgc2hhZG93T3BhY2l0eTogdHJ1ZSxcbiAgc2hhZG93UmFkaXVzOiB0cnVlLFxuICAvKiBsZWdhY3kgYW5kcm9pZCB0cmFuc2Zvcm0gcHJvcGVydGllcyAqL1xuICBzY2FsZVg6IHRydWUsXG4gIHNjYWxlWTogdHJ1ZSxcbiAgdHJhbnNsYXRlWDogdHJ1ZSxcbiAgdHJhbnNsYXRlWTogdHJ1ZSxcbn07XG5cbmNvbnN0IFNVUFBPUlRFRF9UUkFOU0ZPUk1TID0ge1xuICB0cmFuc2xhdGVYOiB0cnVlLFxuICB0cmFuc2xhdGVZOiB0cnVlLFxuICBzY2FsZTogdHJ1ZSxcbiAgc2NhbGVYOiB0cnVlLFxuICBzY2FsZVk6IHRydWUsXG4gIHJvdGF0ZTogdHJ1ZSxcbiAgcm90YXRlWDogdHJ1ZSxcbiAgcm90YXRlWTogdHJ1ZSxcbiAgcm90YXRlWjogdHJ1ZSxcbiAgcGVyc3BlY3RpdmU6IHRydWUsXG59O1xuXG5jb25zdCBTVVBQT1JURURfSU5URVJQT0xBVElPTl9QQVJBTVMgPSB7XG4gIGlucHV0UmFuZ2U6IHRydWUsXG4gIG91dHB1dFJhbmdlOiB0cnVlLFxuICBleHRyYXBvbGF0ZTogdHJ1ZSxcbiAgZXh0cmFwb2xhdGVSaWdodDogdHJ1ZSxcbiAgZXh0cmFwb2xhdGVMZWZ0OiB0cnVlLFxufTtcblxuZnVuY3Rpb24gYWRkV2hpdGVsaXN0ZWRTdHlsZVByb3AocHJvcDogc3RyaW5nKTogdm9pZCB7XG4gIFNVUFBPUlRFRF9TVFlMRVNbcHJvcF0gPSB0cnVlO1xufVxuXG5mdW5jdGlvbiBhZGRXaGl0ZWxpc3RlZFRyYW5zZm9ybVByb3AocHJvcDogc3RyaW5nKTogdm9pZCB7XG4gIFNVUFBPUlRFRF9UUkFOU0ZPUk1TW3Byb3BdID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gYWRkV2hpdGVsaXN0ZWRJbnRlcnBvbGF0aW9uUGFyYW0ocGFyYW06IHN0cmluZyk6IHZvaWQge1xuICBTVVBQT1JURURfSU5URVJQT0xBVElPTl9QQVJBTVNbcGFyYW1dID0gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGVUcmFuc2Zvcm0oXG4gIGNvbmZpZ3M6IEFycmF5PFxuICAgIHwge1xuICAgICAgICB0eXBlOiAnYW5pbWF0ZWQnLFxuICAgICAgICBwcm9wZXJ0eTogc3RyaW5nLFxuICAgICAgICBub2RlVGFnOiA/bnVtYmVyLFxuICAgICAgICAuLi5cbiAgICAgIH1cbiAgICB8IHtcbiAgICAgICAgdHlwZTogJ3N0YXRpYycsXG4gICAgICAgIHByb3BlcnR5OiBzdHJpbmcsXG4gICAgICAgIHZhbHVlOiBudW1iZXIgfCBzdHJpbmcsXG4gICAgICAgIC4uLlxuICAgICAgfSxcbiAgPixcbik6IHZvaWQge1xuICBjb25maWdzLmZvckVhY2goY29uZmlnID0+IHtcbiAgICBpZiAoIVNVUFBPUlRFRF9UUkFOU0ZPUk1TLmhhc093blByb3BlcnR5KGNvbmZpZy5wcm9wZXJ0eSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYFByb3BlcnR5ICcke2NvbmZpZy5wcm9wZXJ0eX0nIGlzIG5vdCBzdXBwb3J0ZWQgYnkgbmF0aXZlIGFuaW1hdGVkIG1vZHVsZWAsXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRlU3R5bGVzKHN0eWxlczoge1trZXk6IHN0cmluZ106ID9udW1iZXIsIC4uLn0pOiB2b2lkIHtcbiAgZm9yIChjb25zdCBrZXkgaW4gc3R5bGVzKSB7XG4gICAgaWYgKCFTVVBQT1JURURfU1RZTEVTLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgYFN0eWxlIHByb3BlcnR5ICcke2tleX0nIGlzIG5vdCBzdXBwb3J0ZWQgYnkgbmF0aXZlIGFuaW1hdGVkIG1vZHVsZWAsXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiB2YWxpZGF0ZUludGVycG9sYXRpb24oY29uZmlnOiBJbnRlcnBvbGF0aW9uQ29uZmlnVHlwZSk6IHZvaWQge1xuICBmb3IgKGNvbnN0IGtleSBpbiBjb25maWcpIHtcbiAgICBpZiAoIVNVUFBPUlRFRF9JTlRFUlBPTEFUSU9OX1BBUkFNUy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgIGBJbnRlcnBvbGF0aW9uIHByb3BlcnR5ICcke2tleX0nIGlzIG5vdCBzdXBwb3J0ZWQgYnkgbmF0aXZlIGFuaW1hdGVkIG1vZHVsZWAsXG4gICAgICApO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZU5ld05vZGVUYWcoKTogbnVtYmVyIHtcbiAgcmV0dXJuIF9fbmF0aXZlQW5pbWF0ZWROb2RlVGFnQ291bnQrKztcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVOZXdBbmltYXRpb25JZCgpOiBudW1iZXIge1xuICByZXR1cm4gX19uYXRpdmVBbmltYXRpb25JZENvdW50Kys7XG59XG5cbmZ1bmN0aW9uIGFzc2VydE5hdGl2ZUFuaW1hdGVkTW9kdWxlKCk6IHZvaWQge1xuICBpbnZhcmlhbnQoTmF0aXZlQW5pbWF0ZWRNb2R1bGUsICdOYXRpdmUgYW5pbWF0ZWQgbW9kdWxlIGlzIG5vdCBhdmFpbGFibGUnKTtcbn1cblxubGV0IF93YXJuZWRNaXNzaW5nTmF0aXZlQW5pbWF0ZWQgPSBmYWxzZTtcblxuZnVuY3Rpb24gc2hvdWxkVXNlTmF0aXZlRHJpdmVyKFxuICBjb25maWc6IHsuLi5BbmltYXRpb25Db25maWcsIC4uLn0gfCBFdmVudENvbmZpZyxcbik6IGJvb2xlYW4ge1xuICBpZiAoY29uZmlnLnVzZU5hdGl2ZURyaXZlciA9PSBudWxsKSB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgJ0FuaW1hdGVkOiBgdXNlTmF0aXZlRHJpdmVyYCB3YXMgbm90IHNwZWNpZmllZC4gVGhpcyBpcyBhIHJlcXVpcmVkICcgK1xuICAgICAgICAnb3B0aW9uIGFuZCBtdXN0IGJlIGV4cGxpY2l0bHkgc2V0IHRvIGB0cnVlYCBvciBgZmFsc2VgJyxcbiAgICApO1xuICB9XG5cbiAgaWYgKGNvbmZpZy51c2VOYXRpdmVEcml2ZXIgPT09IHRydWUgJiYgIU5hdGl2ZUFuaW1hdGVkTW9kdWxlKSB7XG4gICAgaWYgKCFfd2FybmVkTWlzc2luZ05hdGl2ZUFuaW1hdGVkKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdBbmltYXRlZDogYHVzZU5hdGl2ZURyaXZlcmAgaXMgbm90IHN1cHBvcnRlZCBiZWNhdXNlIHRoZSBuYXRpdmUgJyArXG4gICAgICAgICAgJ2FuaW1hdGVkIG1vZHVsZSBpcyBtaXNzaW5nLiBGYWxsaW5nIGJhY2sgdG8gSlMtYmFzZWQgYW5pbWF0aW9uLiBUbyAnICtcbiAgICAgICAgICAncmVzb2x2ZSB0aGlzLCBhZGQgYFJDVEFuaW1hdGlvbmAgbW9kdWxlIHRvIHRoaXMgYXBwLCBvciByZW1vdmUgJyArXG4gICAgICAgICAgJ2B1c2VOYXRpdmVEcml2ZXJgLiAnICtcbiAgICAgICAgICAnTWFrZSBzdXJlIHRvIHJ1biBgcG9kIGluc3RhbGxgIGZpcnN0LiBSZWFkIG1vcmUgYWJvdXQgYXV0b2xpbmtpbmc6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWFjdC1uYXRpdmUtY29tbXVuaXR5L2NsaS9ibG9iL21hc3Rlci9kb2NzL2F1dG9saW5raW5nLm1kJyxcbiAgICAgICk7XG4gICAgICBfd2FybmVkTWlzc2luZ05hdGl2ZUFuaW1hdGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIGNvbmZpZy51c2VOYXRpdmVEcml2ZXIgfHwgZmFsc2U7XG59XG5cbmZ1bmN0aW9uIHRyYW5zZm9ybURhdGFUeXBlKHZhbHVlOiBudW1iZXIgfCBzdHJpbmcpOiBudW1iZXIgfCBzdHJpbmcge1xuICAvLyBDaGFuZ2UgdGhlIHN0cmluZyB0eXBlIHRvIG51bWJlciB0eXBlIHNvIHdlIGNhbiByZXVzZSB0aGUgc2FtZSBsb2dpYyBpblxuICAvLyBpT1MgYW5kIEFuZHJvaWQgcGxhdGZvcm1cbiAgaWYgKHR5cGVvZiB2YWx1ZSAhPT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgaWYgKC9kZWckLy50ZXN0KHZhbHVlKSkge1xuICAgIGNvbnN0IGRlZ3JlZXMgPSBwYXJzZUZsb2F0KHZhbHVlKSB8fCAwO1xuICAgIGNvbnN0IHJhZGlhbnMgPSAoZGVncmVlcyAqIE1hdGguUEkpIC8gMTgwLjA7XG4gICAgcmV0dXJuIHJhZGlhbnM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBBUEksXG4gIGFkZFdoaXRlbGlzdGVkU3R5bGVQcm9wLFxuICBhZGRXaGl0ZWxpc3RlZFRyYW5zZm9ybVByb3AsXG4gIGFkZFdoaXRlbGlzdGVkSW50ZXJwb2xhdGlvblBhcmFtLFxuICB2YWxpZGF0ZVN0eWxlcyxcbiAgdmFsaWRhdGVUcmFuc2Zvcm0sXG4gIHZhbGlkYXRlSW50ZXJwb2xhdGlvbixcbiAgZ2VuZXJhdGVOZXdOb2RlVGFnLFxuICBnZW5lcmF0ZU5ld0FuaW1hdGlvbklkLFxuICBhc3NlcnROYXRpdmVBbmltYXRlZE1vZHVsZSxcbiAgc2hvdWxkVXNlTmF0aXZlRHJpdmVyLFxuICB0cmFuc2Zvcm1EYXRhVHlwZSxcbiAgLy8gJEZsb3dFeHBlY3RlZEVycm9yIC0gdW5zYWZlIGdldHRlciBsaW50IHN1cHByZXNpb25cbiAgZ2V0IG5hdGl2ZUV2ZW50RW1pdHRlcigpOiBOYXRpdmVFdmVudEVtaXR0ZXIge1xuICAgIGlmICghbmF0aXZlRXZlbnRFbWl0dGVyKSB7XG4gICAgICBuYXRpdmVFdmVudEVtaXR0ZXIgPSBuZXcgTmF0aXZlRXZlbnRFbWl0dGVyKE5hdGl2ZUFuaW1hdGVkTW9kdWxlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5hdGl2ZUV2ZW50RW1pdHRlcjtcbiAgfSxcbn07XG4iXX0=