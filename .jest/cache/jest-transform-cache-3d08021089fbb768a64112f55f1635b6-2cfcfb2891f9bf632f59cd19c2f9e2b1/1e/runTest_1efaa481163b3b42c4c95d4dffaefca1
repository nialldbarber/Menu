51222ea30071e09420ab1cdbc30a7530
'use strict';

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _regenerator = _interopRequireDefault2(require("@babel/runtime/regenerator"));

var _defineProperty2 = _interopRequireDefault2(require("@babel/runtime/helpers/defineProperty"));

function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }

Object.defineProperty(exports, '__esModule', {
  value: true
});
exports.default = runTest;

function _chalk() {
  var data = _interopRequireDefault(require('chalk'));

  _chalk = function _chalk() {
    return data;
  };

  return data;
}

function fs() {
  var data = _interopRequireWildcard(require('graceful-fs'));

  fs = function fs() {
    return data;
  };

  return data;
}

function _sourceMapSupport() {
  var data = _interopRequireDefault(require('source-map-support'));

  _sourceMapSupport = function _sourceMapSupport() {
    return data;
  };

  return data;
}

function _console() {
  var data = require('@jest/console');

  _console = function _console() {
    return data;
  };

  return data;
}

function _transform() {
  var data = require('@jest/transform');

  _transform = function _transform() {
    return data;
  };

  return data;
}

function docblock() {
  var data = _interopRequireWildcard(require('jest-docblock'));

  docblock = function docblock() {
    return data;
  };

  return data;
}

function _jestLeakDetector() {
  var data = _interopRequireDefault(require('jest-leak-detector'));

  _jestLeakDetector = function _jestLeakDetector() {
    return data;
  };

  return data;
}

function _jestMessageUtil() {
  var data = require('jest-message-util');

  _jestMessageUtil = function _jestMessageUtil() {
    return data;
  };

  return data;
}

function _jestResolve() {
  var data = require('jest-resolve');

  _jestResolve = function _jestResolve() {
    return data;
  };

  return data;
}

function _jestUtil() {
  var data = require('jest-util');

  _jestUtil = function _jestUtil() {
    return data;
  };

  return data;
}

function _getRequireWildcardCache(nodeInterop) {
  if (typeof WeakMap !== 'function') return null;
  var cacheBabelInterop = new WeakMap();
  var cacheNodeInterop = new WeakMap();
  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {
    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
  })(nodeInterop);
}

function _interopRequireWildcard(obj, nodeInterop) {
  if (!nodeInterop && obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== 'object' && typeof obj !== 'function') {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache(nodeInterop);

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (key !== 'default' && Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function freezeConsole(testConsole, config) {
  testConsole._log = function fakeConsolePush(_type, message) {
    var error = new (_jestUtil().ErrorWithStack)(_chalk().default.red(_chalk().default.bold('Cannot log after tests are done.') + " Did you forget to wait for something async in your test?") + "\nAttempted to log \"" + message + "\".", fakeConsolePush);
    var formattedError = (0, _jestMessageUtil().formatExecError)(error, config, {
      noStackTrace: false
    }, undefined, true);
    process.stderr.write('\n' + formattedError + '\n');
    process.exitCode = 1;
  };
}

function runTestInternal(path, globalConfig, config, resolver, context, sendMessageToJest) {
  var testSource, docblockPragmas, customEnvironment, testEnvironment, cacheFS, transformer, TestEnvironment, testFramework, Runtime, consoleOut, consoleFormatter, testConsole, environment, leakDetector, runtime, start, _iterator, _step, _path, esm, sourcemapOptions, realExit, collectV8Coverage, result, testCount, end, testRuntime, coverage, coverageKeys, v8Coverage;

  return _regenerator.default.async(function runTestInternal$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          testSource = fs().readFileSync(path, 'utf8');
          docblockPragmas = docblock().parse(docblock().extract(testSource));
          customEnvironment = docblockPragmas['jest-environment'];
          testEnvironment = config.testEnvironment;

          if (!customEnvironment) {
            _context.next = 8;
            break;
          }

          if (!Array.isArray(customEnvironment)) {
            _context.next = 7;
            break;
          }

          throw new Error("You can only define a single test environment through docblocks, got \"" + customEnvironment.join(', ') + "\"");

        case 7:
          testEnvironment = (0, _jestResolve().resolveTestEnvironment)(_objectSpread(_objectSpread({}, config), {}, {
            requireResolveFunction: require.resolve,
            testEnvironment: customEnvironment
          }));

        case 8:
          cacheFS = new Map([[path, testSource]]);
          _context.next = 11;
          return _regenerator.default.awrap((0, _transform().createScriptTransformer)(config, cacheFS));

        case 11:
          transformer = _context.sent;
          _context.next = 14;
          return _regenerator.default.awrap(transformer.requireAndTranspileModule(testEnvironment));

        case 14:
          TestEnvironment = _context.sent;
          _context.next = 17;
          return _regenerator.default.awrap(transformer.requireAndTranspileModule(process.env.JEST_JASMINE === '1' ? require.resolve('jest-jasmine2') : config.testRunner));

        case 17:
          testFramework = _context.sent;
          Runtime = (0, _jestUtil().interopRequireDefault)(config.moduleLoader ? require(config.moduleLoader) : require('jest-runtime')).default;
          consoleOut = globalConfig.useStderr ? process.stderr : process.stdout;

          consoleFormatter = function consoleFormatter(type, message) {
            return (0, _console().getConsoleOutput)(_console().BufferedConsole.write([], type, message, 4), config, globalConfig);
          };

          if (globalConfig.silent) {
            testConsole = new (_console().NullConsole)(consoleOut, consoleOut, consoleFormatter);
          } else if (globalConfig.verbose) {
            testConsole = new (_console().CustomConsole)(consoleOut, consoleOut, consoleFormatter);
          } else {
            testConsole = new (_console().BufferedConsole)();
          }

          environment = new TestEnvironment(config, {
            console: testConsole,
            docblockPragmas: docblockPragmas,
            testPath: path
          });

          if (typeof environment.getVmContext !== 'function') {
            console.error("Test environment found at \"" + testEnvironment + "\" does not export a \"getVmContext\" method, which is mandatory from Jest 27. This method is a replacement for \"runScript\".");
            process.exit(1);
          }

          leakDetector = config.detectLeaks ? new (_jestLeakDetector().default)(environment) : null;
          (0, _jestUtil().setGlobal)(environment.global, 'console', testConsole);
          runtime = new Runtime(config, environment, resolver, transformer, cacheFS, {
            changedFiles: context === null || context === void 0 ? void 0 : context.changedFiles,
            collectCoverage: globalConfig.collectCoverage,
            collectCoverageFrom: globalConfig.collectCoverageFrom,
            collectCoverageOnlyFrom: globalConfig.collectCoverageOnlyFrom,
            coverageProvider: globalConfig.coverageProvider,
            sourcesRelatedToTestsInChangedFiles: context === null || context === void 0 ? void 0 : context.sourcesRelatedToTestsInChangedFiles
          }, path);
          start = Date.now();
          _iterator = _createForOfIteratorHelperLoose(config.setupFiles);

        case 29:
          if ((_step = _iterator()).done) {
            _context.next = 40;
            break;
          }

          _path = _step.value;
          esm = runtime.unstable_shouldLoadAsEsm(_path);

          if (!esm) {
            _context.next = 37;
            break;
          }

          _context.next = 35;
          return _regenerator.default.awrap(runtime.unstable_importModule(_path));

        case 35:
          _context.next = 38;
          break;

        case 37:
          runtime.requireModule(_path);

        case 38:
          _context.next = 29;
          break;

        case 40:
          sourcemapOptions = {
            environment: 'node',
            handleUncaughtExceptions: false,
            retrieveSourceMap: function retrieveSourceMap(source) {
              var _runtime$getSourceMap;

              var sourceMapSource = (_runtime$getSourceMap = runtime.getSourceMaps()) === null || _runtime$getSourceMap === void 0 ? void 0 : _runtime$getSourceMap.get(source);

              if (sourceMapSource) {
                try {
                  return {
                    map: JSON.parse(fs().readFileSync(sourceMapSource, 'utf8')),
                    url: source
                  };
                } catch (_unused) {}
              }

              return null;
            }
          };
          runtime.requireInternalModule(require.resolve('source-map-support'), 'source-map-support').install(sourcemapOptions);

          _sourceMapSupport().default.install(sourcemapOptions);

          if (environment.global && environment.global.process && environment.global.process.exit) {
            realExit = environment.global.process.exit;

            environment.global.process.exit = function exit() {
              for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
                args[_key] = arguments[_key];
              }

              var error = new (_jestUtil().ErrorWithStack)("process.exit called with \"" + args.join(', ') + "\"", exit);
              var formattedError = (0, _jestMessageUtil().formatExecError)(error, config, {
                noStackTrace: false
              }, undefined, true);
              process.stderr.write(formattedError);
              return realExit.apply(void 0, args);
            };
          }

          collectV8Coverage = globalConfig.coverageProvider === 'v8' && typeof environment.getVmContext === 'function';
          _context.prev = 45;
          _context.next = 48;
          return _regenerator.default.awrap(environment.setup());

        case 48:
          _context.prev = 48;

          if (!collectV8Coverage) {
            _context.next = 52;
            break;
          }

          _context.next = 52;
          return _regenerator.default.awrap(runtime.collectV8Coverage());

        case 52:
          _context.next = 54;
          return _regenerator.default.awrap(testFramework(globalConfig, config, environment, runtime, path, sendMessageToJest));

        case 54:
          result = _context.sent;
          _context.next = 61;
          break;

        case 57:
          _context.prev = 57;
          _context.t0 = _context["catch"](48);
          _context.t0.stack;
          throw _context.t0;

        case 61:
          _context.prev = 61;

          if (!collectV8Coverage) {
            _context.next = 65;
            break;
          }

          _context.next = 65;
          return _regenerator.default.awrap(runtime.stopCollectingV8Coverage());

        case 65:
          return _context.finish(61);

        case 66:
          freezeConsole(testConsole, config);
          testCount = result.numPassingTests + result.numFailingTests + result.numPendingTests + result.numTodoTests;
          end = Date.now();
          testRuntime = end - start;
          result.perfStats = {
            end: end,
            runtime: testRuntime,
            slow: testRuntime / 1000 > config.slowTestThreshold,
            start: start
          };
          result.testFilePath = path;
          result.console = testConsole.getBuffer();
          result.skipped = testCount === result.numPendingTests;
          result.displayName = config.displayName;
          coverage = runtime.getAllCoverageInfoCopy();

          if (coverage) {
            coverageKeys = Object.keys(coverage);

            if (coverageKeys.length) {
              result.coverage = coverage;
            }
          }

          if (collectV8Coverage) {
            v8Coverage = runtime.getAllV8CoverageInfoCopy();

            if (v8Coverage && v8Coverage.length > 0) {
              result.v8Coverage = v8Coverage;
            }
          }

          if (globalConfig.logHeapUsage) {
            if (global.gc) {
              global.gc();
            }

            result.memoryUsage = process.memoryUsage().heapUsed;
          }

          return _context.abrupt("return", new Promise(function (resolve) {
            setImmediate(function () {
              return resolve({
                leakDetector: leakDetector,
                result: result
              });
            });
          }));

        case 80:
          _context.prev = 80;
          runtime.teardown();
          _context.next = 84;
          return _regenerator.default.awrap(environment.teardown());

        case 84:
          _sourceMapSupport().default.resetRetrieveHandlers();

          return _context.finish(80);

        case 86:
        case "end":
          return _context.stop();
      }
    }
  }, null, null, [[45,, 80, 86], [48, 57, 61, 66]], Promise);
}

function runTest(path, globalConfig, config, resolver, context, sendMessageToJest) {
  var _await$runTestInterna, leakDetector, result;

  return _regenerator.default.async(function runTest$(_context2) {
    while (1) {
      switch (_context2.prev = _context2.next) {
        case 0:
          _context2.next = 2;
          return _regenerator.default.awrap(runTestInternal(path, globalConfig, config, resolver, context, sendMessageToJest));

        case 2:
          _await$runTestInterna = _context2.sent;
          leakDetector = _await$runTestInterna.leakDetector;
          result = _await$runTestInterna.result;

          if (!leakDetector) {
            _context2.next = 13;
            break;
          }

          _context2.next = 8;
          return _regenerator.default.awrap(new Promise(function (resolve) {
            return setTimeout(resolve, 100);
          }));

        case 8:
          _context2.next = 10;
          return _regenerator.default.awrap(leakDetector.isLeaking());

        case 10:
          result.leaks = _context2.sent;
          _context2.next = 14;
          break;

        case 13:
          result.leaks = false;

        case 14:
          return _context2.abrupt("return", result);

        case 15:
        case "end":
          return _context2.stop();
      }
    }
  }, null, null, null, Promise);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJ1blRlc3QuanMiXSwibmFtZXMiOlsiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwidmFsdWUiLCJkZWZhdWx0IiwicnVuVGVzdCIsIl9jaGFsayIsImRhdGEiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImZzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfc291cmNlTWFwU3VwcG9ydCIsIl9jb25zb2xlIiwiX3RyYW5zZm9ybSIsImRvY2Jsb2NrIiwiX2plc3RMZWFrRGV0ZWN0b3IiLCJfamVzdE1lc3NhZ2VVdGlsIiwiX2plc3RSZXNvbHZlIiwiX2plc3RVdGlsIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwibm9kZUludGVyb3AiLCJXZWFrTWFwIiwiY2FjaGVCYWJlbEludGVyb3AiLCJjYWNoZU5vZGVJbnRlcm9wIiwib2JqIiwiX19lc01vZHVsZSIsImNhY2hlIiwiaGFzIiwiZ2V0IiwibmV3T2JqIiwiaGFzUHJvcGVydHlEZXNjcmlwdG9yIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiZGVzYyIsInNldCIsImZyZWV6ZUNvbnNvbGUiLCJ0ZXN0Q29uc29sZSIsImNvbmZpZyIsIl9sb2ciLCJmYWtlQ29uc29sZVB1c2giLCJfdHlwZSIsIm1lc3NhZ2UiLCJlcnJvciIsIkVycm9yV2l0aFN0YWNrIiwicmVkIiwiYm9sZCIsImZvcm1hdHRlZEVycm9yIiwiZm9ybWF0RXhlY0Vycm9yIiwibm9TdGFja1RyYWNlIiwidW5kZWZpbmVkIiwicHJvY2VzcyIsInN0ZGVyciIsIndyaXRlIiwiZXhpdENvZGUiLCJydW5UZXN0SW50ZXJuYWwiLCJwYXRoIiwiZ2xvYmFsQ29uZmlnIiwicmVzb2x2ZXIiLCJjb250ZXh0Iiwic2VuZE1lc3NhZ2VUb0plc3QiLCJ0ZXN0U291cmNlIiwicmVhZEZpbGVTeW5jIiwiZG9jYmxvY2tQcmFnbWFzIiwicGFyc2UiLCJleHRyYWN0IiwiY3VzdG9tRW52aXJvbm1lbnQiLCJ0ZXN0RW52aXJvbm1lbnQiLCJBcnJheSIsImlzQXJyYXkiLCJFcnJvciIsImpvaW4iLCJyZXNvbHZlVGVzdEVudmlyb25tZW50IiwicmVxdWlyZVJlc29sdmVGdW5jdGlvbiIsInJlc29sdmUiLCJjYWNoZUZTIiwiTWFwIiwiY3JlYXRlU2NyaXB0VHJhbnNmb3JtZXIiLCJ0cmFuc2Zvcm1lciIsInJlcXVpcmVBbmRUcmFuc3BpbGVNb2R1bGUiLCJUZXN0RW52aXJvbm1lbnQiLCJlbnYiLCJKRVNUX0pBU01JTkUiLCJ0ZXN0UnVubmVyIiwidGVzdEZyYW1ld29yayIsIlJ1bnRpbWUiLCJpbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJtb2R1bGVMb2FkZXIiLCJjb25zb2xlT3V0IiwidXNlU3RkZXJyIiwic3Rkb3V0IiwiY29uc29sZUZvcm1hdHRlciIsInR5cGUiLCJnZXRDb25zb2xlT3V0cHV0IiwiQnVmZmVyZWRDb25zb2xlIiwic2lsZW50IiwiTnVsbENvbnNvbGUiLCJ2ZXJib3NlIiwiQ3VzdG9tQ29uc29sZSIsImVudmlyb25tZW50IiwiY29uc29sZSIsInRlc3RQYXRoIiwiZ2V0Vm1Db250ZXh0IiwiZXhpdCIsImxlYWtEZXRlY3RvciIsImRldGVjdExlYWtzIiwic2V0R2xvYmFsIiwiZ2xvYmFsIiwicnVudGltZSIsImNoYW5nZWRGaWxlcyIsImNvbGxlY3RDb3ZlcmFnZSIsImNvbGxlY3RDb3ZlcmFnZUZyb20iLCJjb2xsZWN0Q292ZXJhZ2VPbmx5RnJvbSIsImNvdmVyYWdlUHJvdmlkZXIiLCJzb3VyY2VzUmVsYXRlZFRvVGVzdHNJbkNoYW5nZWRGaWxlcyIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsInNldHVwRmlsZXMiLCJlc20iLCJ1bnN0YWJsZV9zaG91bGRMb2FkQXNFc20iLCJ1bnN0YWJsZV9pbXBvcnRNb2R1bGUiLCJyZXF1aXJlTW9kdWxlIiwic291cmNlbWFwT3B0aW9ucyIsImhhbmRsZVVuY2F1Z2h0RXhjZXB0aW9ucyIsInJldHJpZXZlU291cmNlTWFwIiwic291cmNlIiwiX3J1bnRpbWUkZ2V0U291cmNlTWFwIiwic291cmNlTWFwU291cmNlIiwiZ2V0U291cmNlTWFwcyIsIm1hcCIsIkpTT04iLCJ1cmwiLCJyZXF1aXJlSW50ZXJuYWxNb2R1bGUiLCJpbnN0YWxsIiwicmVhbEV4aXQiLCJhcmdzIiwiY29sbGVjdFY4Q292ZXJhZ2UiLCJzZXR1cCIsInJlc3VsdCIsInN0YWNrIiwic3RvcENvbGxlY3RpbmdWOENvdmVyYWdlIiwidGVzdENvdW50IiwibnVtUGFzc2luZ1Rlc3RzIiwibnVtRmFpbGluZ1Rlc3RzIiwibnVtUGVuZGluZ1Rlc3RzIiwibnVtVG9kb1Rlc3RzIiwiZW5kIiwidGVzdFJ1bnRpbWUiLCJwZXJmU3RhdHMiLCJzbG93Iiwic2xvd1Rlc3RUaHJlc2hvbGQiLCJ0ZXN0RmlsZVBhdGgiLCJnZXRCdWZmZXIiLCJza2lwcGVkIiwiZGlzcGxheU5hbWUiLCJjb3ZlcmFnZSIsImdldEFsbENvdmVyYWdlSW5mb0NvcHkiLCJjb3ZlcmFnZUtleXMiLCJrZXlzIiwibGVuZ3RoIiwidjhDb3ZlcmFnZSIsImdldEFsbFY4Q292ZXJhZ2VJbmZvQ29weSIsImxvZ0hlYXBVc2FnZSIsImdjIiwibWVtb3J5VXNhZ2UiLCJoZWFwVXNlZCIsIlByb21pc2UiLCJzZXRJbW1lZGlhdGUiLCJ0ZWFyZG93biIsInJlc2V0UmV0cmlldmVIYW5kbGVycyIsInNldFRpbWVvdXQiLCJpc0xlYWtpbmciLCJsZWFrcyJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQzNDQyxFQUFBQSxLQUFLLEVBQUU7QUFEb0MsQ0FBN0M7QUFHQUQsT0FBTyxDQUFDRSxPQUFSLEdBQWtCQyxPQUFsQjs7QUFFQSxTQUFTQyxNQUFULEdBQWtCO0FBQ2hCLE1BQU1DLElBQUksR0FBR0Msc0JBQXNCLENBQUNDLE9BQU8sQ0FB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a0QsRUFHbERuQixNQUhrRCxFQUlsRG9CLFFBSmtELEVBS2xEQyxPQUxrRCxFQU1sREMsaUJBTmtELENBUnREOztBQUFBO0FBQUE7QUFRUzRDLFVBQUFBLFlBUlQseUJBUVNBLFlBUlQ7QUFRdUJtQyxVQUFBQSxNQVJ2Qix5QkFRdUJBLE1BUnZCOztBQUFBLGVBaUJNbkMsWUFqQk47QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFBQSw0Q0FtQlUsSUFBSStELE9BQUosQ0FBWSxVQUFBN0YsT0FBTztBQUFBLG1CQUFJaUcsVUFBVSxDQUFDakcsT0FBRCxFQUFVLEdBQVYsQ0FBZDtBQUFBLFdBQW5CLENBbkJWOztBQUFBO0FBQUE7QUFBQSw0Q0FxQnlCOEIsWUFBWSxDQUFDb0UsU0FBYixFQXJCekI7O0FBQUE7QUFxQklqQyxVQUFBQSxNQUFNLENBQUNrQyxLQXJCWDtBQUFBO0FBQUE7O0FBQUE7QUF1QklsQyxVQUFBQSxNQUFNLENBQUNrQyxLQUFQLEdBQWUsS0FBZjs7QUF2Qko7QUFBQSw0Q0EwQlNsQyxNQTFCVDs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmRlZmF1bHQgPSBydW5UZXN0O1xuXG5mdW5jdGlvbiBfY2hhbGsoKSB7XG4gIGNvbnN0IGRhdGEgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoJ2NoYWxrJykpO1xuXG4gIF9jaGFsayA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gZnMoKSB7XG4gIGNvbnN0IGRhdGEgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChyZXF1aXJlKCdncmFjZWZ1bC1mcycpKTtcblxuICBmcyA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gX3NvdXJjZU1hcFN1cHBvcnQoKSB7XG4gIGNvbnN0IGRhdGEgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoJ3NvdXJjZS1tYXAtc3VwcG9ydCcpKTtcblxuICBfc291cmNlTWFwU3VwcG9ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gX2NvbnNvbGUoKSB7XG4gIGNvbnN0IGRhdGEgPSByZXF1aXJlKCdAamVzdC9jb25zb2xlJyk7XG5cbiAgX2NvbnNvbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIF90cmFuc2Zvcm0oKSB7XG4gIGNvbnN0IGRhdGEgPSByZXF1aXJlKCdAamVzdC90cmFuc2Zvcm0nKTtcblxuICBfdHJhbnNmb3JtID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBkYXRhO1xuICB9O1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBkb2NibG9jaygpIHtcbiAgY29uc3QgZGF0YSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKHJlcXVpcmUoJ2plc3QtZG9jYmxvY2snKSk7XG5cbiAgZG9jYmxvY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIF9qZXN0TGVha0RldGVjdG9yKCkge1xuICBjb25zdCBkYXRhID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCdqZXN0LWxlYWstZGV0ZWN0b3InKSk7XG5cbiAgX2plc3RMZWFrRGV0ZWN0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIF9qZXN0TWVzc2FnZVV0aWwoKSB7XG4gIGNvbnN0IGRhdGEgPSByZXF1aXJlKCdqZXN0LW1lc3NhZ2UtdXRpbCcpO1xuXG4gIF9qZXN0TWVzc2FnZVV0aWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH07XG5cbiAgcmV0dXJuIGRhdGE7XG59XG5cbmZ1bmN0aW9uIF9qZXN0UmVzb2x2ZSgpIHtcbiAgY29uc3QgZGF0YSA9IHJlcXVpcmUoJ2plc3QtcmVzb2x2ZScpO1xuXG4gIF9qZXN0UmVzb2x2ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZGF0YTtcbiAgfTtcblxuICByZXR1cm4gZGF0YTtcbn1cblxuZnVuY3Rpb24gX2plc3RVdGlsKCkge1xuICBjb25zdCBkYXRhID0gcmVxdWlyZSgnamVzdC11dGlsJyk7XG5cbiAgX2plc3RVdGlsID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBkYXRhO1xuICB9O1xuXG4gIHJldHVybiBkYXRhO1xufVxuXG5mdW5jdGlvbiBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApIHtcbiAgaWYgKHR5cGVvZiBXZWFrTWFwICE9PSAnZnVuY3Rpb24nKSByZXR1cm4gbnVsbDtcbiAgdmFyIGNhY2hlQmFiZWxJbnRlcm9wID0gbmV3IFdlYWtNYXAoKTtcbiAgdmFyIGNhY2hlTm9kZUludGVyb3AgPSBuZXcgV2Vha01hcCgpO1xuICByZXR1cm4gKF9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSA9IGZ1bmN0aW9uIChub2RlSW50ZXJvcCkge1xuICAgIHJldHVybiBub2RlSW50ZXJvcCA/IGNhY2hlTm9kZUludGVyb3AgOiBjYWNoZUJhYmVsSW50ZXJvcDtcbiAgfSkobm9kZUludGVyb3ApO1xufVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmosIG5vZGVJbnRlcm9wKSB7XG4gIGlmICghbm9kZUludGVyb3AgJiYgb2JqICYmIG9iai5fX2VzTW9kdWxlKSB7XG4gICAgcmV0dXJuIG9iajtcbiAgfVxuICBpZiAob2JqID09PSBudWxsIHx8ICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyAmJiB0eXBlb2Ygb2JqICE9PSAnZnVuY3Rpb24nKSkge1xuICAgIHJldHVybiB7ZGVmYXVsdDogb2JqfTtcbiAgfVxuICB2YXIgY2FjaGUgPSBfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUobm9kZUludGVyb3ApO1xuICBpZiAoY2FjaGUgJiYgY2FjaGUuaGFzKG9iaikpIHtcbiAgICByZXR1cm4gY2FjaGUuZ2V0KG9iaik7XG4gIH1cbiAgdmFyIG5ld09iaiA9IHt9O1xuICB2YXIgaGFzUHJvcGVydHlEZXNjcmlwdG9yID1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkgJiYgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcjtcbiAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgIGlmIChrZXkgIT09ICdkZWZhdWx0JyAmJiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICB2YXIgZGVzYyA9IGhhc1Byb3BlcnR5RGVzY3JpcHRvclxuICAgICAgICA/IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqLCBrZXkpXG4gICAgICAgIDogbnVsbDtcbiAgICAgIGlmIChkZXNjICYmIChkZXNjLmdldCB8fCBkZXNjLnNldCkpIHtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ld09iaiwga2V5LCBkZXNjKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld09ialtrZXldID0gb2JqW2tleV07XG4gICAgICB9XG4gICAgfVxuICB9XG4gIG5ld09iai5kZWZhdWx0ID0gb2JqO1xuICBpZiAoY2FjaGUpIHtcbiAgICBjYWNoZS5zZXQob2JqLCBuZXdPYmopO1xuICB9XG4gIHJldHVybiBuZXdPYmo7XG59XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7XG4gIHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7ZGVmYXVsdDogb2JqfTtcbn1cblxuLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKi9cbmZ1bmN0aW9uIGZyZWV6ZUNvbnNvbGUodGVzdENvbnNvbGUsIGNvbmZpZykge1xuICAvLyBAdHMtZXhwZWN0LWVycm9yOiBgX2xvZ2AgaXMgYHByaXZhdGVgIC0gd2Ugc2hvdWxkIGZpZ3VyZSBvdXQgc29tZSBwcm9wZXIgQVBJIGhlcmVcbiAgdGVzdENvbnNvbGUuX2xvZyA9IGZ1bmN0aW9uIGZha2VDb25zb2xlUHVzaChfdHlwZSwgbWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yID0gbmV3IChfamVzdFV0aWwoKS5FcnJvcldpdGhTdGFjaykoXG4gICAgICBgJHtfY2hhbGsoKS5kZWZhdWx0LnJlZChcbiAgICAgICAgYCR7X2NoYWxrKCkuZGVmYXVsdC5ib2xkKFxuICAgICAgICAgICdDYW5ub3QgbG9nIGFmdGVyIHRlc3RzIGFyZSBkb25lLidcbiAgICAgICAgKX0gRGlkIHlvdSBmb3JnZXQgdG8gd2FpdCBmb3Igc29tZXRoaW5nIGFzeW5jIGluIHlvdXIgdGVzdD9gXG4gICAgICApfVxcbkF0dGVtcHRlZCB0byBsb2cgXCIke21lc3NhZ2V9XCIuYCxcbiAgICAgIGZha2VDb25zb2xlUHVzaFxuICAgICk7XG4gICAgY29uc3QgZm9ybWF0dGVkRXJyb3IgPSAoMCwgX2plc3RNZXNzYWdlVXRpbCgpLmZvcm1hdEV4ZWNFcnJvcikoXG4gICAgICBlcnJvcixcbiAgICAgIGNvbmZpZyxcbiAgICAgIHtcbiAgICAgICAgbm9TdGFja1RyYWNlOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIHRydWVcbiAgICApO1xuICAgIHByb2Nlc3Muc3RkZXJyLndyaXRlKCdcXG4nICsgZm9ybWF0dGVkRXJyb3IgKyAnXFxuJyk7XG4gICAgcHJvY2Vzcy5leGl0Q29kZSA9IDE7XG4gIH07XG59IC8vIEtlZXBpbmcgdGhlIGNvcmUgb2YgXCJydW5UZXN0XCIgYXMgYSBzZXBhcmF0ZSBmdW5jdGlvbiAoYXMgXCJydW5UZXN0SW50ZXJuYWxcIilcbi8vIGlzIGtleSB0byBiZSBhYmxlIHRvIGRldGVjdCBtZW1vcnkgbGVha3MuIFNpbmNlIGFsbCB2YXJpYWJsZXMgYXJlIGxvY2FsIHRvXG4vLyB0aGUgZnVuY3Rpb24sIHdoZW4gXCJydW5UZXN0SW50ZXJuYWxcIiBmaW5pc2hlcyBpdHMgZXhlY3V0aW9uLCB0aGV5IGNhbiBhbGwgYmVcbi8vIGZyZWVkLCBVTkxFU1Mgc29tZXRoaW5nIGVsc2UgaXMgbGVha2luZyB0aGVtIChhbmQgdGhhdCdzIHdoeSB3ZSBjYW4gZGV0ZWN0XG4vLyB0aGUgbGVhayEpLlxuLy9cbi8vIElmIHdlIGhhZCBhbGwgdGhlIGNvZGUgaW4gYSBzaW5nbGUgZnVuY3Rpb24sIHdlIHNob3VsZCBtYW51YWxseSBudWxsaWZ5IGFsbFxuLy8gcmVmZXJlbmNlcyB0byB2ZXJpZnkgaWYgdGhlcmUgaXMgYSBsZWFrLCB3aGljaCBpcyBub3QgbWFpbnRhaW5hYmxlIGFuZCBlcnJvclxuLy8gcHJvbmUuIFRoYXQncyB3aHkgXCJydW5UZXN0SW50ZXJuYWxcIiBDQU5OT1QgYmUgaW5saW5lZCBpbnNpZGUgXCJydW5UZXN0XCIuXG5cbmFzeW5jIGZ1bmN0aW9uIHJ1blRlc3RJbnRlcm5hbChcbiAgcGF0aCxcbiAgZ2xvYmFsQ29uZmlnLFxuICBjb25maWcsXG4gIHJlc29sdmVyLFxuICBjb250ZXh0LFxuICBzZW5kTWVzc2FnZVRvSmVzdFxuKSB7XG4gIGNvbnN0IHRlc3RTb3VyY2UgPSBmcygpLnJlYWRGaWxlU3luYyhwYXRoLCAndXRmOCcpO1xuICBjb25zdCBkb2NibG9ja1ByYWdtYXMgPSBkb2NibG9jaygpLnBhcnNlKGRvY2Jsb2NrKCkuZXh0cmFjdCh0ZXN0U291cmNlKSk7XG4gIGNvbnN0IGN1c3RvbUVudmlyb25tZW50ID0gZG9jYmxvY2tQcmFnbWFzWydqZXN0LWVudmlyb25tZW50J107XG4gIGxldCB0ZXN0RW52aXJvbm1lbnQgPSBjb25maWcudGVzdEVudmlyb25tZW50O1xuXG4gIGlmIChjdXN0b21FbnZpcm9ubWVudCkge1xuICAgIGlmIChBcnJheS5pc0FycmF5KGN1c3RvbUVudmlyb25tZW50KSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICBgWW91IGNhbiBvbmx5IGRlZmluZSBhIHNpbmdsZSB0ZXN0IGVudmlyb25tZW50IHRocm91Z2ggZG9jYmxvY2tzLCBnb3QgXCIke2N1c3RvbUVudmlyb25tZW50LmpvaW4oXG4gICAgICAgICAgJywgJ1xuICAgICAgICApfVwiYFxuICAgICAgKTtcbiAgICB9XG5cbiAgICB0ZXN0RW52aXJvbm1lbnQgPSAoMCwgX2plc3RSZXNvbHZlKCkucmVzb2x2ZVRlc3RFbnZpcm9ubWVudCkoe1xuICAgICAgLi4uY29uZmlnLFxuICAgICAgcmVxdWlyZVJlc29sdmVGdW5jdGlvbjogcmVxdWlyZS5yZXNvbHZlLFxuICAgICAgdGVzdEVudmlyb25tZW50OiBjdXN0b21FbnZpcm9ubWVudFxuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgY2FjaGVGUyA9IG5ldyBNYXAoW1twYXRoLCB0ZXN0U291cmNlXV0pO1xuICBjb25zdCB0cmFuc2Zvcm1lciA9IGF3YWl0ICgwLCBfdHJhbnNmb3JtKCkuY3JlYXRlU2NyaXB0VHJhbnNmb3JtZXIpKFxuICAgIGNvbmZpZyxcbiAgICBjYWNoZUZTXG4gICk7XG4gIGNvbnN0IFRlc3RFbnZpcm9ubWVudCA9IGF3YWl0IHRyYW5zZm9ybWVyLnJlcXVpcmVBbmRUcmFuc3BpbGVNb2R1bGUoXG4gICAgdGVzdEVudmlyb25tZW50XG4gICk7XG4gIGNvbnN0IHRlc3RGcmFtZXdvcmsgPSBhd2FpdCB0cmFuc2Zvcm1lci5yZXF1aXJlQW5kVHJhbnNwaWxlTW9kdWxlKFxuICAgIHByb2Nlc3MuZW52LkpFU1RfSkFTTUlORSA9PT0gJzEnXG4gICAgICA/IHJlcXVpcmUucmVzb2x2ZSgnamVzdC1qYXNtaW5lMicpXG4gICAgICA6IGNvbmZpZy50ZXN0UnVubmVyXG4gICk7XG4gIGNvbnN0IFJ1bnRpbWUgPSAoMCwgX2plc3RVdGlsKCkuaW50ZXJvcFJlcXVpcmVEZWZhdWx0KShcbiAgICBjb25maWcubW9kdWxlTG9hZGVyID8gcmVxdWlyZShjb25maWcubW9kdWxlTG9hZGVyKSA6IHJlcXVpcmUoJ2plc3QtcnVudGltZScpXG4gICkuZGVmYXVsdDtcbiAgY29uc3QgY29uc29sZU91dCA9IGdsb2JhbENvbmZpZy51c2VTdGRlcnIgPyBwcm9jZXNzLnN0ZGVyciA6IHByb2Nlc3Muc3Rkb3V0O1xuXG4gIGNvbnN0IGNvbnNvbGVGb3JtYXR0ZXIgPSAodHlwZSwgbWVzc2FnZSkgPT5cbiAgICAoMCwgX2NvbnNvbGUoKS5nZXRDb25zb2xlT3V0cHV0KShcbiAgICAgIC8vIDQgPSB0aGUgY29uc29sZSBjYWxsIGlzIGJ1cmllZCA0IHN0YWNrIGZyYW1lcyBkZWVwXG4gICAgICBfY29uc29sZSgpLkJ1ZmZlcmVkQ29uc29sZS53cml0ZShbXSwgdHlwZSwgbWVzc2FnZSwgNCksXG4gICAgICBjb25maWcsXG4gICAgICBnbG9iYWxDb25maWdcbiAgICApO1xuXG4gIGxldCB0ZXN0Q29uc29sZTtcblxuICBpZiAoZ2xvYmFsQ29uZmlnLnNpbGVudCkge1xuICAgIHRlc3RDb25zb2xlID0gbmV3IChfY29uc29sZSgpLk51bGxDb25zb2xlKShcbiAgICAgIGNvbnNvbGVPdXQsXG4gICAgICBjb25zb2xlT3V0LFxuICAgICAgY29uc29sZUZvcm1hdHRlclxuICAgICk7XG4gIH0gZWxzZSBpZiAoZ2xvYmFsQ29uZmlnLnZlcmJvc2UpIHtcbiAgICB0ZXN0Q29uc29sZSA9IG5ldyAoX2NvbnNvbGUoKS5DdXN0b21Db25zb2xlKShcbiAgICAgIGNvbnNvbGVPdXQsXG4gICAgICBjb25zb2xlT3V0LFxuICAgICAgY29uc29sZUZvcm1hdHRlclxuICAgICk7XG4gIH0gZWxzZSB7XG4gICAgdGVzdENvbnNvbGUgPSBuZXcgKF9jb25zb2xlKCkuQnVmZmVyZWRDb25zb2xlKSgpO1xuICB9XG5cbiAgY29uc3QgZW52aXJvbm1lbnQgPSBuZXcgVGVzdEVudmlyb25tZW50KGNvbmZpZywge1xuICAgIGNvbnNvbGU6IHRlc3RDb25zb2xlLFxuICAgIGRvY2Jsb2NrUHJhZ21hcyxcbiAgICB0ZXN0UGF0aDogcGF0aFxuICB9KTtcblxuICBpZiAodHlwZW9mIGVudmlyb25tZW50LmdldFZtQ29udGV4dCAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICBgVGVzdCBlbnZpcm9ubWVudCBmb3VuZCBhdCBcIiR7dGVzdEVudmlyb25tZW50fVwiIGRvZXMgbm90IGV4cG9ydCBhIFwiZ2V0Vm1Db250ZXh0XCIgbWV0aG9kLCB3aGljaCBpcyBtYW5kYXRvcnkgZnJvbSBKZXN0IDI3LiBUaGlzIG1ldGhvZCBpcyBhIHJlcGxhY2VtZW50IGZvciBcInJ1blNjcmlwdFwiLmBcbiAgICApO1xuICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgfVxuXG4gIGNvbnN0IGxlYWtEZXRlY3RvciA9IGNvbmZpZy5kZXRlY3RMZWFrc1xuICAgID8gbmV3IChfamVzdExlYWtEZXRlY3RvcigpLmRlZmF1bHQpKGVudmlyb25tZW50KVxuICAgIDogbnVsbDtcbiAgKDAsIF9qZXN0VXRpbCgpLnNldEdsb2JhbCkoZW52aXJvbm1lbnQuZ2xvYmFsLCAnY29uc29sZScsIHRlc3RDb25zb2xlKTtcbiAgY29uc3QgcnVudGltZSA9IG5ldyBSdW50aW1lKFxuICAgIGNvbmZpZyxcbiAgICBlbnZpcm9ubWVudCxcbiAgICByZXNvbHZlcixcbiAgICB0cmFuc2Zvcm1lcixcbiAgICBjYWNoZUZTLFxuICAgIHtcbiAgICAgIGNoYW5nZWRGaWxlczpcbiAgICAgICAgY29udGV4dCA9PT0gbnVsbCB8fCBjb250ZXh0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb250ZXh0LmNoYW5nZWRGaWxlcyxcbiAgICAgIGNvbGxlY3RDb3ZlcmFnZTogZ2xvYmFsQ29uZmlnLmNvbGxlY3RDb3ZlcmFnZSxcbiAgICAgIGNvbGxlY3RDb3ZlcmFnZUZyb206IGdsb2JhbENvbmZpZy5jb2xsZWN0Q292ZXJhZ2VGcm9tLFxuICAgICAgY29sbGVjdENvdmVyYWdlT25seUZyb206IGdsb2JhbENvbmZpZy5jb2xsZWN0Q292ZXJhZ2VPbmx5RnJvbSxcbiAgICAgIGNvdmVyYWdlUHJvdmlkZXI6IGdsb2JhbENvbmZpZy5jb3ZlcmFnZVByb3ZpZGVyLFxuICAgICAgc291cmNlc1JlbGF0ZWRUb1Rlc3RzSW5DaGFuZ2VkRmlsZXM6XG4gICAgICAgIGNvbnRleHQgPT09IG51bGwgfHwgY29udGV4dCA9PT0gdm9pZCAwXG4gICAgICAgICAgPyB2b2lkIDBcbiAgICAgICAgICA6IGNvbnRleHQuc291cmNlc1JlbGF0ZWRUb1Rlc3RzSW5DaGFuZ2VkRmlsZXNcbiAgICB9LFxuICAgIHBhdGhcbiAgKTtcbiAgY29uc3Qgc3RhcnQgPSBEYXRlLm5vdygpO1xuXG4gIGZvciAoY29uc3QgcGF0aCBvZiBjb25maWcuc2V0dXBGaWxlcykge1xuICAgIGNvbnN0IGVzbSA9IHJ1bnRpbWUudW5zdGFibGVfc2hvdWxkTG9hZEFzRXNtKHBhdGgpO1xuXG4gICAgaWYgKGVzbSkge1xuICAgICAgYXdhaXQgcnVudGltZS51bnN0YWJsZV9pbXBvcnRNb2R1bGUocGF0aCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJ1bnRpbWUucmVxdWlyZU1vZHVsZShwYXRoKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzb3VyY2VtYXBPcHRpb25zID0ge1xuICAgIGVudmlyb25tZW50OiAnbm9kZScsXG4gICAgaGFuZGxlVW5jYXVnaHRFeGNlcHRpb25zOiBmYWxzZSxcbiAgICByZXRyaWV2ZVNvdXJjZU1hcDogc291cmNlID0+IHtcbiAgICAgIHZhciBfcnVudGltZSRnZXRTb3VyY2VNYXA7XG5cbiAgICAgIGNvbnN0IHNvdXJjZU1hcFNvdXJjZSA9XG4gICAgICAgIChfcnVudGltZSRnZXRTb3VyY2VNYXAgPSBydW50aW1lLmdldFNvdXJjZU1hcHMoKSkgPT09IG51bGwgfHxcbiAgICAgICAgX3J1bnRpbWUkZ2V0U291cmNlTWFwID09PSB2b2lkIDBcbiAgICAgICAgICA/IHZvaWQgMFxuICAgICAgICAgIDogX3J1bnRpbWUkZ2V0U291cmNlTWFwLmdldChzb3VyY2UpO1xuXG4gICAgICBpZiAoc291cmNlTWFwU291cmNlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1hcDogSlNPTi5wYXJzZShmcygpLnJlYWRGaWxlU3luYyhzb3VyY2VNYXBTb3VyY2UsICd1dGY4JykpLFxuICAgICAgICAgICAgdXJsOiBzb3VyY2VcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIHt9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfTsgLy8gRm9yIHRlc3RzXG5cbiAgcnVudGltZVxuICAgIC5yZXF1aXJlSW50ZXJuYWxNb2R1bGUoXG4gICAgICByZXF1aXJlLnJlc29sdmUoJ3NvdXJjZS1tYXAtc3VwcG9ydCcpLFxuICAgICAgJ3NvdXJjZS1tYXAtc3VwcG9ydCdcbiAgICApXG4gICAgLmluc3RhbGwoc291cmNlbWFwT3B0aW9ucyk7IC8vIEZvciBydW50aW1lIGVycm9yc1xuXG4gIF9zb3VyY2VNYXBTdXBwb3J0KCkuZGVmYXVsdC5pbnN0YWxsKHNvdXJjZW1hcE9wdGlvbnMpO1xuXG4gIGlmIChcbiAgICBlbnZpcm9ubWVudC5nbG9iYWwgJiZcbiAgICBlbnZpcm9ubWVudC5nbG9iYWwucHJvY2VzcyAmJlxuICAgIGVudmlyb25tZW50Lmdsb2JhbC5wcm9jZXNzLmV4aXRcbiAgKSB7XG4gICAgY29uc3QgcmVhbEV4aXQgPSBlbnZpcm9ubWVudC5nbG9iYWwucHJvY2Vzcy5leGl0O1xuXG4gICAgZW52aXJvbm1lbnQuZ2xvYmFsLnByb2Nlc3MuZXhpdCA9IGZ1bmN0aW9uIGV4aXQoLi4uYXJncykge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgKF9qZXN0VXRpbCgpLkVycm9yV2l0aFN0YWNrKShcbiAgICAgICAgYHByb2Nlc3MuZXhpdCBjYWxsZWQgd2l0aCBcIiR7YXJncy5qb2luKCcsICcpfVwiYCxcbiAgICAgICAgZXhpdFxuICAgICAgKTtcbiAgICAgIGNvbnN0IGZvcm1hdHRlZEVycm9yID0gKDAsIF9qZXN0TWVzc2FnZVV0aWwoKS5mb3JtYXRFeGVjRXJyb3IpKFxuICAgICAgICBlcnJvcixcbiAgICAgICAgY29uZmlnLFxuICAgICAgICB7XG4gICAgICAgICAgbm9TdGFja1RyYWNlOiBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICB1bmRlZmluZWQsXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgICBwcm9jZXNzLnN0ZGVyci53cml0ZShmb3JtYXR0ZWRFcnJvcik7XG4gICAgICByZXR1cm4gcmVhbEV4aXQoLi4uYXJncyk7XG4gICAgfTtcbiAgfSAvLyBpZiB3ZSBkb24ndCBoYXZlIGBnZXRWbUNvbnRleHRgIG9uIHRoZSBlbnYgc2tpcCBjb3ZlcmFnZVxuXG4gIGNvbnN0IGNvbGxlY3RWOENvdmVyYWdlID1cbiAgICBnbG9iYWxDb25maWcuY292ZXJhZ2VQcm92aWRlciA9PT0gJ3Y4JyAmJlxuICAgIHR5cGVvZiBlbnZpcm9ubWVudC5nZXRWbUNvbnRleHQgPT09ICdmdW5jdGlvbic7XG5cbiAgdHJ5IHtcbiAgICBhd2FpdCBlbnZpcm9ubWVudC5zZXR1cCgpO1xuICAgIGxldCByZXN1bHQ7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKGNvbGxlY3RWOENvdmVyYWdlKSB7XG4gICAgICAgIGF3YWl0IHJ1bnRpbWUuY29sbGVjdFY4Q292ZXJhZ2UoKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0ID0gYXdhaXQgdGVzdEZyYW1ld29yayhcbiAgICAgICAgZ2xvYmFsQ29uZmlnLFxuICAgICAgICBjb25maWcsXG4gICAgICAgIGVudmlyb25tZW50LFxuICAgICAgICBydW50aW1lLFxuICAgICAgICBwYXRoLFxuICAgICAgICBzZW5kTWVzc2FnZVRvSmVzdFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIC8vIEFjY2VzcyBzdGFjayBiZWZvcmUgdW5pbnN0YWxsaW5nIHNvdXJjZW1hcHNcbiAgICAgIGVyci5zdGFjaztcbiAgICAgIHRocm93IGVycjtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgaWYgKGNvbGxlY3RWOENvdmVyYWdlKSB7XG4gICAgICAgIGF3YWl0IHJ1bnRpbWUuc3RvcENvbGxlY3RpbmdWOENvdmVyYWdlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnJlZXplQ29uc29sZSh0ZXN0Q29uc29sZSwgY29uZmlnKTtcbiAgICBjb25zdCB0ZXN0Q291bnQgPVxuICAgICAgcmVzdWx0Lm51bVBhc3NpbmdUZXN0cyArXG4gICAgICByZXN1bHQubnVtRmFpbGluZ1Rlc3RzICtcbiAgICAgIHJlc3VsdC5udW1QZW5kaW5nVGVzdHMgK1xuICAgICAgcmVzdWx0Lm51bVRvZG9UZXN0cztcbiAgICBjb25zdCBlbmQgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHRlc3RSdW50aW1lID0gZW5kIC0gc3RhcnQ7XG4gICAgcmVzdWx0LnBlcmZTdGF0cyA9IHtcbiAgICAgIGVuZCxcbiAgICAgIHJ1bnRpbWU6IHRlc3RSdW50aW1lLFxuICAgICAgc2xvdzogdGVzdFJ1bnRpbWUgLyAxMDAwID4gY29uZmlnLnNsb3dUZXN0VGhyZXNob2xkLFxuICAgICAgc3RhcnRcbiAgICB9O1xuICAgIHJlc3VsdC50ZXN0RmlsZVBhdGggPSBwYXRoO1xuICAgIHJlc3VsdC5jb25zb2xlID0gdGVzdENvbnNvbGUuZ2V0QnVmZmVyKCk7XG4gICAgcmVzdWx0LnNraXBwZWQgPSB0ZXN0Q291bnQgPT09IHJlc3VsdC5udW1QZW5kaW5nVGVzdHM7XG4gICAgcmVzdWx0LmRpc3BsYXlOYW1lID0gY29uZmlnLmRpc3BsYXlOYW1lO1xuICAgIGNvbnN0IGNvdmVyYWdlID0gcnVudGltZS5nZXRBbGxDb3ZlcmFnZUluZm9Db3B5KCk7XG5cbiAgICBpZiAoY292ZXJhZ2UpIHtcbiAgICAgIGNvbnN0IGNvdmVyYWdlS2V5cyA9IE9iamVjdC5rZXlzKGNvdmVyYWdlKTtcblxuICAgICAgaWYgKGNvdmVyYWdlS2V5cy5sZW5ndGgpIHtcbiAgICAgICAgcmVzdWx0LmNvdmVyYWdlID0gY292ZXJhZ2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGNvbGxlY3RWOENvdmVyYWdlKSB7XG4gICAgICBjb25zdCB2OENvdmVyYWdlID0gcnVudGltZS5nZXRBbGxWOENvdmVyYWdlSW5mb0NvcHkoKTtcblxuICAgICAgaWYgKHY4Q292ZXJhZ2UgJiYgdjhDb3ZlcmFnZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlc3VsdC52OENvdmVyYWdlID0gdjhDb3ZlcmFnZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZ2xvYmFsQ29uZmlnLmxvZ0hlYXBVc2FnZSkge1xuICAgICAgaWYgKGdsb2JhbC5nYykge1xuICAgICAgICBnbG9iYWwuZ2MoKTtcbiAgICAgIH1cblxuICAgICAgcmVzdWx0Lm1lbW9yeVVzYWdlID0gcHJvY2Vzcy5tZW1vcnlVc2FnZSgpLmhlYXBVc2VkO1xuICAgIH0gLy8gRGVsYXkgdGhlIHJlc29sdXRpb24gdG8gYWxsb3cgbG9nIG1lc3NhZ2VzIHRvIGJlIG91dHB1dC5cblxuICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcbiAgICAgIHNldEltbWVkaWF0ZSgoKSA9PlxuICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICBsZWFrRGV0ZWN0b3IsXG4gICAgICAgICAgcmVzdWx0XG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH0pO1xuICB9IGZpbmFsbHkge1xuICAgIHJ1bnRpbWUudGVhcmRvd24oKTtcbiAgICBhd2FpdCBlbnZpcm9ubWVudC50ZWFyZG93bigpO1xuXG4gICAgX3NvdXJjZU1hcFN1cHBvcnQoKS5kZWZhdWx0LnJlc2V0UmV0cmlldmVIYW5kbGVycygpO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJ1blRlc3QoXG4gIHBhdGgsXG4gIGdsb2JhbENvbmZpZyxcbiAgY29uZmlnLFxuICByZXNvbHZlcixcbiAgY29udGV4dCxcbiAgc2VuZE1lc3NhZ2VUb0plc3Rcbikge1xuICBjb25zdCB7bGVha0RldGVjdG9yLCByZXN1bHR9ID0gYXdhaXQgcnVuVGVzdEludGVybmFsKFxuICAgIHBhdGgsXG4gICAgZ2xvYmFsQ29uZmlnLFxuICAgIGNvbmZpZyxcbiAgICByZXNvbHZlcixcbiAgICBjb250ZXh0LFxuICAgIHNlbmRNZXNzYWdlVG9KZXN0XG4gICk7XG5cbiAgaWYgKGxlYWtEZXRlY3Rvcikge1xuICAgIC8vIFdlIHdhbm5hIGFsbG93IGEgdGlueSBidXQgdGltZSB0byBwYXNzIHRvIGFsbG93IGxhc3QtbWludXRlIGNsZWFudXBcbiAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7IC8vIFJlc29sdmUgbGVhayBkZXRlY3Rvciwgb3V0c2lkZSB0aGUgXCJydW5UZXN0SW50ZXJuYWxcIiBjbG9zdXJlLlxuXG4gICAgcmVzdWx0LmxlYWtzID0gYXdhaXQgbGVha0RldGVjdG9yLmlzTGVha2luZygpO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdC5sZWFrcyA9IGZhbHNlO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdfQ==